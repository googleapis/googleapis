# Copyright 2019 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# DO NOT EDIT! This is a generated sample configuration.

---
type: SampleTestProto
schema_version: 1.2.0
test:
  suites:
  - name: AutoML Natural Language – Dataset Management
    setup:
    - env:
        name: GOOGLE_PROJECT_ID
        variable: project_id
    - code: dataset_display_name = "a" + uuid().replace("-", "")[:30]
    - log:
      - 'Dataset display_name for test: {}'
      - dataset_display_name
    teardown:
    - log:
      - Cleaning up dataset (in case delete step was not run)
    - call_may_fail:
        params:
          project:
            variable: project_id
          dataset_id:
            variable: generated_dataset_id
        sample: automl_natural_language_delete_dataset
    cases:
    - name: Create, List, Get, Update, and Delete
      spec:
      - call:
          params:
            project:
              variable: project_id
          sample: automl_natural_language_list_datasets
      - assert_not_contains:
        - variable: dataset_display_name
      - call:
          params:
            project:
              variable: project_id
            display_name:
              variable: dataset_display_name
          sample: automl_natural_language_create_dataset
      - extract_match:
          pattern: datasets/([^\s]+)
          variable: generated_dataset_id
      - log:
        - 'Generated Dataset ID: {}'
        - generated_dataset_id
      - assert_contains:
        - literal: Created dataset
        - literal: Name
        - literal: Display Name
        - literal: Description
        - variable: dataset_display_name
      - &1
        assert_contains:
        - literal: 'Text Classification Type: MULTILABEL'
      - call:
          params:
            project:
              variable: project_id
          sample: automl_natural_language_list_datasets
      - assert_contains:
        - literal: Name
        - variable: generated_dataset_id
        - literal: Display Name
        - variable: dataset_display_name
        - literal: Description
      - *1
      - call:
          params:
            project:
              variable: project_id
            dataset_id:
              variable: generated_dataset_id
          sample: automl_natural_language_get_dataset
      - assert_contains:
        - literal: Name
        - variable: generated_dataset_id
        - literal: Display Name
        - variable: dataset_display_name
        - literal: Description
      - *1
      - log:
        - Deleting dataset (may take a minute)
      - call:
          params:
            project:
              variable: project_id
            dataset_id:
              variable: generated_dataset_id
          sample: automl_natural_language_delete_dataset
      - assert_contains:
        - literal: Deleted dataset
      - call:
          params:
            project:
              variable: project_id
          sample: automl_natural_language_list_datasets
      - assert_not_contains:
        - variable: dataset_display_name
        - variable: generated_dataset_id
