// Copyright 2026 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

package backstory;

import "google/api/field_behavior.proto";
import "google/cloud/chronicle/backstory/data_access.proto";
import "google/cloud/chronicle/backstory/id.proto";
import "google/protobuf/duration.proto";
import "google/protobuf/struct.proto";
import "google/protobuf/timestamp.proto";
import "google/type/interval.proto";
import "google/type/latlng.proto";

option csharp_namespace = "Google.Cloud.Chronicle.Backstory";
option go_package = "google.golang.org/genproto/googleapis/backstory;backstory";
option java_multiple_files = true;
option java_package = "com.google.googlex.security.malachite.proto.external";
option php_namespace = "Google\\Cloud\\Chronicle\\Backstory";
option ruby_package = "Google::Cloud::Chronicle::Backstory";

// General information associated with a UDM event.
message Metadata {
  // Enum representing the type of timestamp that the event_timestamp field
  // represents.
  enum EventTimestampAttribute {
    // Default event timestamp attribute.
    EVENT_TIMESTAMP_ATTRIBUTE_UNSPECIFIED = 0;

    // Deprecated. Use LAST_ACCESSED instead.
    FILE_LAST_ACCESS_TIME = 1 [deprecated = true];

    // Deprecated. Use LAST_MODIFIED instead.
    FILE_LAST_MODIFIED_TIME = 2 [deprecated = true];

    // Deprecated. Use METADATA_LAST_CHANGED instead.
    FILE_METADATA_LAST_CHANGE_TIME = 3 [deprecated = true];

    // Deprecated. Use CREATED instead.
    FILE_CREATION_TIME = 4 [deprecated = true];

    // Deprecated. Use COLLECTED instead.
    COLLECTED_TIME = 5 [deprecated = true];

    // The time when the event was collected by the vendor's local
    // collection infrastructure.
    COLLECTED = 6;

    // The time when the file was accessed.
    ACCESSED = 7;

    // The time when the file was changed.
    CHANGED = 8;

    // The time when the file was first created.
    CREATED = 9;

    // The time when the file name was accessed.
    FILE_NAME_ACCESSED = 10;

    // The time when the file name was changed.
    FILE_NAME_CHANGED = 11;

    // The time when the file name was created.
    FILE_NAME_CREATED = 12;

    // The time when the file name was last accessed.
    FILE_NAME_LAST_ACCESSED = 13;

    // The time when the file name was last modified.
    FILE_NAME_LAST_MODIFIED = 14;

    // The time when the file name metadata was last changed.
    FILE_NAME_METADATA_LAST_CHANGED = 15;

    // The time when the file name was modified.
    FILE_NAME_MODIFIED = 16;

    // The time when the file was last accessed.
    LAST_ACCESSED = 17;

    // The time when the file was last modified.
    LAST_MODIFIED = 18;

    // The time when the file metadata was last changed.
    METADATA_LAST_CHANGED = 19;

    // The time when the file was modified.
    MODIFIED = 20;

    // Added Timestamp.
    ADDED = 21;

    // Backed Up Timestamp.
    BACKED_UP = 22;

    // Last Connected timestamp.
    LAST_CONNECTED = 23;

    // Deleted Timestamp.
    DELETED = 24;

    // Ended Timestamp.
    ENDED = 25;

    // Exited Timestamp.
    EXITED = 26;

    // Expired Timestamp.
    EXPIRED = 27;

    // First Accessed Timestamp.
    FIRST_ACCESSED = 28;

    // Appeared Timestamp.
    APPEARED = 29;

    // Installed Timestamp.
    INSTALLED = 30;

    // Last Active Timestamp.
    LAST_ACTIVE = 31;

    // Last Login Timestamp.
    LAST_LOGGED_IN = 32;

    // Last Login Attempt Timestamp.
    LAST_LOGIN_ATTEMPT = 33;

    // Last Password Set Timestamp.
    LAST_PASSWORD_SET = 34;

    // Last Printed Timestamp.
    LAST_PRINTED = 35;

    // Last Resumed Timestamp.
    LAST_RESUMED = 36;

    // Last Executed Timestamp.
    LAST_EXECUTED = 37;

    // Last Seen Timestamp.
    LAST_SEEN = 38;

    // Last Shutdown Timestamp.
    LAST_SHUTDOWN = 39;

    // Last Updated Timestamp.
    LAST_UPDATED = 40;

    // Last Used Timestamp.
    LAST_USED = 41;

    // Last Visited Timestamp.
    LAST_VISITED = 42;

    // Linked Timestamp.
    LINKED = 43;

    // Metadata Modified Timestamp.
    METADATA_MODIFIED = 44;

    // Modified Timestamp.
    CONTENT_MODIFIED = 45;

    // Purchased Timestamp.
    PURCHASED = 46;

    // Recorded Timestamp.
    RECORDED = 47;

    // Request Received Timestamp.
    REQUEST_RECEIVED = 48;

    // Response Sent Timestamp.
    RESPONSE_SENT = 49;

    // Scheduled to End Timestamp.
    SCHEDULED_TO_END = 50;

    // Scheduled to Start Timestamp.
    SCHEDULED_TO_START = 51;

    // Sent Timestamp.
    SENT = 52;

    // Started Timestamp.
    STARTED = 53;

    // Updated Timestamp.
    UPDATED = 54;

    // Validated Timestamp.
    VALIDATED = 55;

    // Most Recent Run Timestamp.
    MOST_RECENT_RUN = 56;

    // Next Run Timestamp.
    NEXT_RUN = 57;

    // Visited Timestamp.
    VISITED = 58;

    // Target Created Timestamp.
    TARGET_CREATED = 59;

    // Volume Created Timestamp.
    VOLUME_CREATED = 60;

    // Post Checked Timestamp.
    POST_CHECKED = 61;

    // Synchronized Timestamp.
    SYNCHRONIZED = 62;

    // Item Created Timestamp.
    ITEM_CREATED = 63;

    // Item Modified Timestamp.
    ITEM_MODIFIED = 64;

    // Document Last Saved Timestamp.
    DOCUMENT_LAST_SAVED = 65;

    // Last Registered Timestamp.
    LAST_REGISTERED = 66;

    // Launched Timestamp.
    LAUNCHED = 67;

    // First Visited Timestamp.
    FIRST_VISITED = 68;

    // First Seen Timestamp.
    FIRST_SEEN = 69;

    // Downloaded Timestamp.
    DOWNLOADED = 70;
  }

  // An event type.
  // Choose event type not based on the product that generated the event but the
  // one that logged the event itself. So, for example, an antivirus (AV)
  // scanning email on a client would generate an SMTP_PROXY event, not an AV
  // event. A DLP device scanning a web upload would generate an HTTP_PROXY
  // event and not a DLP or process activity event. Note: In the case of a
  // HTTP_PROXY event, you might also include process details if this occurred
  // on an endpoint. That would be optional, but there are a certain set of
  // required fields and banned fields due to its status as an HTTP_PROXY event.
  enum EventType {
    // Default event type
    EVENTTYPE_UNSPECIFIED = 0;

    // Activity related to a process which does not match any other event types.
    PROCESS_UNCATEGORIZED = 10000;

    // Process launch.
    PROCESS_LAUNCH = 10001;

    // Process injecting into another process.
    PROCESS_INJECTION = 10002;

    // Process privilege escalation.
    PROCESS_PRIVILEGE_ESCALATION = 10003;

    // Process termination.
    PROCESS_TERMINATION = 10004;

    // Process being opened.
    PROCESS_OPEN = 10005;

    // Process loading a module.
    PROCESS_MODULE_LOAD = 10006;

    // Registry event which does not match any of the other event types.
    REGISTRY_UNCATEGORIZED = 11000;

    // Registry creation.
    REGISTRY_CREATION = 11001;

    // Registry modification.
    REGISTRY_MODIFICATION = 11002;

    // Registry deletion.
    REGISTRY_DELETION = 11003;

    // Settings-related event which does not match any of the other
    // event types.
    SETTING_UNCATEGORIZED = 12000;

    // Setting creation.
    SETTING_CREATION = 12001;

    // Setting modification.
    SETTING_MODIFICATION = 12002;

    // Setting deletion.
    SETTING_DELETION = 12003;

    // Any mutex event other than creation.
    MUTEX_UNCATEGORIZED = 13000;

    // Mutex creation.
    MUTEX_CREATION = 13001;

    // File event which does not match any of the other event types.
    FILE_UNCATEGORIZED = 14000;

    // File created.
    FILE_CREATION = 14001;

    // File deleted.
    FILE_DELETION = 14002;

    // File modified.
    FILE_MODIFICATION = 14003;

    // File read.
    FILE_READ = 14004;

    // File copied.
    // Used for file copies, for example, to a thumb drive.
    FILE_COPY = 14005;

    // File opened.
    FILE_OPEN = 14006;

    // File moved or renamed.
    FILE_MOVE = 14007;

    // File synced (for example, Google Drive, Dropbox, backup).
    FILE_SYNC = 14008;

    // User activity which does not match any of the other event types.
    USER_UNCATEGORIZED = 15000;

    // User login.
    USER_LOGIN = 15001;

    // User logout.
    USER_LOGOUT = 15002;

    // User creation.
    USER_CREATION = 15003;

    // User password change event.
    USER_CHANGE_PASSWORD = 15004;

    // Change in user permissions.
    USER_CHANGE_PERMISSIONS = 15005;

    // Deprecated. Used to update user info for an LDAP dump.
    USER_STATS = 15006 [deprecated = true];

    // User physically badging into a location.
    USER_BADGE_IN = 15007;

    // User deletion.
    USER_DELETION = 15008;

    // User creating a virtual resource.
    // This is equivalent to RESOURCE_CREATION.
    USER_RESOURCE_CREATION = 15009;

    // User updating content of a virtual resource.
    // This is equivalent to RESOURCE_WRITTEN.
    USER_RESOURCE_UPDATE_CONTENT = 15010;

    // User updating permissions of a virtual resource.
    // This is equivalent to RESOURCE_PERMISSIONS_CHANGE.
    USER_RESOURCE_UPDATE_PERMISSIONS = 15011;

    // User initiating communication through a medium (for example, video).
    USER_COMMUNICATION = 15012;

    // User accessing a virtual resource.
    // This is equivalent to RESOURCE_READ.
    USER_RESOURCE_ACCESS = 15013;

    // User deleting a virtual resource.
    // This is equivalent to RESOURCE_DELETION.
    USER_RESOURCE_DELETION = 15014;

    // A group activity that does not fall into one of the other event types.
    GROUP_UNCATEGORIZED = 23000;

    // A group creation.
    GROUP_CREATION = 23001;

    // A group deletion.
    GROUP_DELETION = 23002;

    // A group modification.
    GROUP_MODIFICATION = 23003;

    // Email messages
    EMAIL_UNCATEGORIZED = 19000;

    // An email transaction.
    EMAIL_TRANSACTION = 19001;

    // Deprecated: use NETWORK_HTTP instead. An email URL click event.
    EMAIL_URL_CLICK = 19002 [deprecated = true];

    // A network event that does not fit into one of the other event types.
    NETWORK_UNCATEGORIZED = 16000;

    // Aggregated flow stats like netflow.
    NETWORK_FLOW = 16001;

    // Network connection details like from a FW.
    NETWORK_CONNECTION = 16002;

    // FTP telemetry.
    NETWORK_FTP = 16003;

    // DHCP payload.
    NETWORK_DHCP = 16004;

    // DNS payload.
    NETWORK_DNS = 16005;

    // HTTP telemetry.
    NETWORK_HTTP = 16006;

    // SMTP telemetry.
    NETWORK_SMTP = 16007;

    // A status message that does not fit into one of the other event types.
    STATUS_UNCATEGORIZED = 17000;

    // Heartbeat indicating product is alive.
    STATUS_HEARTBEAT = 17001;

    // An agent startup.
    STATUS_STARTUP = 17002;

    // An agent shutdown.
    STATUS_SHUTDOWN = 17003;

    // A software or fingerprint update.
    STATUS_UPDATE = 17004;

    // Scan item that does not fit into one of the other event types.
    SCAN_UNCATEGORIZED = 18000;

    // A file scan.
    SCAN_FILE = 18001;

    // Scan process behaviors.
    // Please use SCAN_PROCESS instead.
    SCAN_PROCESS_BEHAVIORS = 18002 [deprecated = true];

    // Scan process.
    SCAN_PROCESS = 18003;

    // Scan results from scanning an entire host device for threats/sensitive
    // documents.
    SCAN_HOST = 18004;

    // Vulnerability scan logs about host vulnerabilities (e.g., out of date
    // software) and network vulnerabilities (e.g., unprotected service detected
    // via a network scan).
    SCAN_VULN_HOST = 18005;

    // Vulnerability scan logs about network vulnerabilities.
    SCAN_VULN_NETWORK = 18006;

    // Scan network for suspicious activity
    SCAN_NETWORK = 18007;

    // Scheduled task event that does not fall into one of the other
    // event types.
    SCHEDULED_TASK_UNCATEGORIZED = 20000;

    // Scheduled task creation.
    SCHEDULED_TASK_CREATION = 20001;

    // Scheduled task deletion.
    SCHEDULED_TASK_DELETION = 20002;

    // Scheduled task being enabled.
    SCHEDULED_TASK_ENABLE = 20003;

    // Scheduled task being disabled.
    SCHEDULED_TASK_DISABLE = 20004;

    // Scheduled task being modified.
    SCHEDULED_TASK_MODIFICATION = 20005;

    // A system audit log event that is not a wipe.
    SYSTEM_AUDIT_LOG_UNCATEGORIZED = 21000;

    // A system audit log wipe.
    SYSTEM_AUDIT_LOG_WIPE = 21001;

    // Service event that does not fit into one of the other event types.
    SERVICE_UNSPECIFIED = 22000;

    // A service creation.
    SERVICE_CREATION = 22001;

    // A service deletion.
    SERVICE_DELETION = 22002;

    // A service start.
    SERVICE_START = 22003;

    // A service stop.
    SERVICE_STOP = 22004;

    // A service modification.
    SERVICE_MODIFICATION = 22005;

    // Operating system events that are not described by any of the other
    // event types. Might include uncategorized Microsoft Windows event logs.
    GENERIC_EVENT = 100000;

    // The resource was created/provisioned.
    // This is equivalent to USER_RESOURCE_CREATION.
    RESOURCE_CREATION = 1;

    // The resource was deleted/deprovisioned.
    // This is equivalent to USER_RESOURCE_DELETION.
    RESOURCE_DELETION = 2;

    // The resource had it's permissions or ACLs updated.
    // This is equivalent to USER_RESOURCE_UPDATE_PERMISSIONS.
    RESOURCE_PERMISSIONS_CHANGE = 3;

    // The resource was read.
    // This is equivalent to USER_RESOURCE_ACCESS.
    RESOURCE_READ = 4;

    // The resource was written to.
    // This is equivalent to USER_RESOURCE_UPDATE_CONTENT.
    RESOURCE_WRITTEN = 5;

    // Firmware update.
    DEVICE_FIRMWARE_UPDATE = 25000;

    // Configuration update.
    DEVICE_CONFIG_UPDATE = 25001;

    // A program or application uploaded to a device.
    DEVICE_PROGRAM_UPLOAD = 25002;

    // A program or application downloaded to a device.
    DEVICE_PROGRAM_DOWNLOAD = 25003;

    // Analyst update about the Verdict (such as true positive, false positive,
    // or disregard) of a finding.
    ANALYST_UPDATE_VERDICT = 24000;

    // Analyst update about the Reputation (such as useful or not useful) of a
    // finding.
    ANALYST_UPDATE_REPUTATION = 24001;

    // Analyst update about the Severity score (0-100) of a finding.
    ANALYST_UPDATE_SEVERITY_SCORE = 24002;

    // Analyst update about the finding status.
    ANALYST_UPDATE_STATUS = 24007;

    // Analyst addition of a comment for a finding.
    ANALYST_ADD_COMMENT = 24008;

    // Analyst update about the priority (such as low, medium, or high) for a
    // finding.
    ANALYST_UPDATE_PRIORITY = 24009;

    // Analyst update about the root cause for a finding.
    ANALYST_UPDATE_ROOT_CAUSE = 24010;

    // Analyst update about the reason (such as malicious or not malicious) for
    // a finding.
    ANALYST_UPDATE_REASON = 24011;

    // Analyst update about the risk score (0-100) of a finding.
    ANALYST_UPDATE_RISK_SCORE = 24012;

    // An update to an entity risk score. This event type is restricted to
    // events published by Google Securit Operations Risk Analytics.
    ENTITY_RISK_CHANGE = 26000;

    // Triage Agent has investigated the finding.
    TRIAGE_AGENT_UPDATE_INVESTIGATION = 27000;
  }

  // An enrichment state.
  enum EnrichmentState {
    // Unspecified.
    ENRICHMENT_STATE_UNSPECIFIED = 0;

    // The event has been enriched by Chronicle.
    ENRICHED = 1;

    // The event has not been enriched by Chronicle.
    UNENRICHED = 2;
  }

  // ID of the UDM event. Can be used for raw and normalized event retrieval.
  bytes id = 15;

  // A vendor-specific event identifier to uniquely identify the event (e.g. a
  // GUID).
  string product_log_id = 1;

  // The GMT timestamp when the event was generated.
  google.protobuf.Timestamp event_timestamp = 2;

  // Attributes associated with event_timestamp. This field
  // is used to distinguish between different types of timestamps that can be
  // used to represent the event_timestamp.
  repeated EventTimestampAttribute event_timestamp_attributes = 21;

  // The GMT timestamp when the event was collected by the vendor's local
  // collection infrastructure.
  google.protobuf.Timestamp collected_timestamp = 3;

  // The GMT timestamp when the event was ingested (received) by Chronicle.
  google.protobuf.Timestamp ingested_timestamp = 11;

  // The event type.
  // If an event has multiple possible types, this specifies the most specific
  // type.
  EventType event_type = 4;

  // The name of the product vendor.
  string vendor_name = 5;

  // The name of the product.
  string product_name = 6;

  // The version of the product.
  string product_version = 7;

  // A short, descriptive, human-readable, product-specific event name or type
  // (e.g. "Scanned X", "User account created", "process_start").
  string product_event_type = 8;

  // The deployment identifier assigned by the vendor for a product deployment.
  string product_deployment_id = 14;

  // A human-readable unparsable description of the event.
  string description = 9;

  // A URL that takes the user to the source product console for this event.
  string url_back_to_product = 10;

  // User-configured ingestion metadata labels.
  repeated Label ingestion_labels = 12;

  // Tags added by Chronicle after an event is parsed. It is an error to
  // populate this field from within a parser.
  Tags tags = 13;

  // The enrichment state.
  EnrichmentState enrichment_state = 16;

  // The string value of log type.
  string log_type = 17;

  // Data access labels on the base event.
  DataAccessLabels base_labels = 18;

  // Data access labels from all the contextual events used to enrich the base
  // event.
  DataAccessLabels enrichment_labels = 19;

  // Flattened fields extracted from the log.
  google.protobuf.Struct structured_fields = 20 [deprecated = true];

  // The version of the parser that generated this UDM event.
  string parser_version = 22;
}

// Attribute is a container for generic entity attributes including common
// attributes across core entities (such as, user or asset). For example, Cloud
// is a generic entity attribute since it can apply to an asset (for example, a
// VM) or a user (for example, an identity service account).
message Attribute {
  // Cloud metadata attributes such as project ID, account ID, or organizational
  // hierarchy.
  Cloud cloud = 1;

  // Set of labels for the entity. Should only be used for product labels (for
  // example, Google Cloud resource labels or Azure AD sensitivity labels.
  // Should not be used for arbitrary key-value mappings.
  repeated Label labels = 2;

  // System permissions for IAM entity
  // (human principal, service account, group).
  repeated Permission permissions = 705;

  // System IAM roles to be assumed by resources to use the role's permissions
  // for access control.
  repeated Role roles = 3;

  // Time the resource or entity was created or provisioned.
  google.protobuf.Timestamp creation_time = 4;

  // Time the resource or entity was last updated.
  google.protobuf.Timestamp last_update_time = 5;
}

// A network event.
message Network {
  // A network traffic direction.
  enum Direction {
    // The default direction.
    UNKNOWN_DIRECTION = 0;

    // An inbound request.
    INBOUND = 1;

    // An outbound request.
    OUTBOUND = 2;

    // A broadcast.
    BROADCAST = 3;
  }

  // An IP protocol.
  enum IpProtocol {
    // The default protocol.
    UNKNOWN_IP_PROTOCOL = 0;

    // ICMP.
    ICMP = 1;

    // IGMP
    IGMP = 2;

    // TCP.
    TCP = 6;

    // UDP.
    UDP = 17;

    // IPv6 Encapsulation
    IP6IN4 = 41;

    // Generic Routing Encapsulation
    GRE = 47;

    // Encapsulating Security Payload
    ESP = 50;

    // ICMPv6
    ICMP6 = 58;

    // Enhanced Interior Gateway Routing
    EIGRP = 88;

    // Ethernet-within-IP Encapsulation
    ETHERIP = 97;

    // Protocol Independent Multicast
    PIM = 103;

    // Virtual Router Redundancy Protocol
    VRRP = 112;

    // Stream Control Transmission Protocol
    SCTP = 132;
  }

  // A network application protocol.
  enum ApplicationProtocol {
    // The default application protocol.
    UNKNOWN_APPLICATION_PROTOCOL = 0;

    // Apple Filing Protocol.
    AFP = 1;

    // Advanced Program-to-Program Communication.
    APPC = 2;

    // Advanced Message Queuing Protocol.
    AMQP = 3;

    // Publishing Protocol.
    ATOM = 4;

    // Block Extensible Exchange Protocol.
    BEEP = 5;

    // Crypto currency protocol.
    BITCOIN = 6;

    // Peer-to-peer file sharing.
    BIT_TORRENT = 7;

    // Coherent File Distribution Protocol.
    CFDP = 8;

    // Common Industrial Protocol.
    CIP = 67;

    // Constrained Application Protocol.
    COAP = 9;

    // Connection Oriented Transport Protocol.
    COTP = 68;

    // DCE/RPC.
    DCERPC = 66;

    // Data Distribution Service.
    DDS = 10;

    // Automation industry protocol.
    DEVICE_NET = 11;

    // DHCP.
    DHCP = 4000;

    // Digital Imaging and Communications in Medicine Protocol.
    DICOM = 69;

    // Distributed Network Protocol 3 (DNP3)
    DNP3 = 70;

    // DNS.
    DNS = 3000;

    // Classic file sharing protocol.
    E_DONKEY = 12;

    // Endpoint Handlespace Redundancy Protocol.
    ENRP = 13;

    // Filesharing peer-to-peer protocol.
    FAST_TRACK = 14;

    // User Information Protocol.
    FINGER = 15;

    // Censorship resistant peer-to-peer network.
    FREENET = 16;

    // File Transfer Access and Management.
    FTAM = 17;

    // GOOSE Protocol.
    GOOSE = 71;

    // Gopher protocol.
    GOPHER = 18;

    // gRPC Remote Procedure Call.
    GRPC = 77;

    // Health Level Seven.
    HL7 = 19;

    // Packet-based multimedia communications system.
    H323 = 20;

    // HTTP.
    HTTP = 2000;

    // HTTPS.
    HTTPS = 2001;

    // IEC 60870-5-104 (IEC 104) Protocol.
    IEC104 = 72;

    // Internet Relay Chat Protocol.
    IRCP = 21;

    // Peer-to-peer hashtables.
    KADEMLIA = 22;

    // Kerberos 5.
    KRB5 = 65;

    // Lightweight Directory Access Protocol.
    LDAP = 23;

    // Line Printer Daemon Protocol.
    LPD = 24;

    // Multipurpose Internet Mail Extensions and Secure MIME.
    MIME = 25;

    // Multimedia Messaging Service.
    MMS = 73;

    // Serial communications protocol.
    MODBUS = 26;

    // Message Queuing Telemetry Transport.
    MQTT = 27;

    // Network Configuration.
    NETCONF = 28;

    // Network File System.
    NFS = 29;

    // Network Information Service.
    NIS = 30;

    // Network News Transfer Protocol.
    NNTP = 31;

    // National Transportation Communications for Intelligent Transportation
    // System.
    NTCIP = 32;

    // Network Time Protocol.
    NTP = 33;

    // AOL Instant Messenger Protocol.
    OSCAR = 34;

    // Peer Name Resolution Protocol.
    PNRP = 35;

    // Precision Time Protocol.
    PTP = 74;

    // QUIC.
    QUIC = 1000;

    // Remote Desktop Protocol.
    RDP = 36;

    // Reliable Event Logging Protocol.
    RELP = 37;

    // Routing Information Protocol.
    RIP = 38;

    // Remote Login in UNIX Systems.
    RLOGIN = 39;

    // Remote Procedure Call.
    RPC = 40;

    // Real Time Messaging Protocol.
    RTMP = 41;

    // Real-time Transport Protocol.
    RTP = 42;

    // Real Time Publish Subscribe.
    RTPS = 43;

    // Real Time Streaming Protocol.
    RTSP = 44;

    // Session Announcement Protocol.
    SAP = 45;

    // Session Description Protocol.
    SDP = 46;

    // Session Initiation Protocol.
    SIP = 47;

    // Service Location Protocol.
    SLP = 48;

    // Server Message Block.
    SMB = 49;

    // Simple Mail Transfer Protocol.
    SMTP = 50;

    // Simple Network Management Protocol.
    SNMP = 75;

    // Simple Network Time Protocol.
    SNTP = 51;

    // Secure Shell.
    SSH = 52;

    // Secure SMS Messaging Protocol.
    SSMS = 53;

    // Styx/9P - Plan 9 from Bell Labs distributed file system protocol.
    STYX = 54;

    // Sampled Values Protocol.
    SV = 76;

    // Transaction Capabilities Application Part.
    TCAP = 55;

    // Tabular Data Stream.
    TDS = 56;

    // Anonymity network.
    TOR = 57;

    // Time Stamp Protocol.
    TSP = 58;

    // Virtual Terminal Protocol.
    VTP = 59;

    // Remote Directory Access Protocol.
    WHOIS = 60;

    // Web Distributed Authoring and Versioning.
    WEB_DAV = 61;

    // Message Handling Service Protocol.
    X400 = 62;

    // Directory Access Protocol (DAP).
    X500 = 63;

    // Extensible Messaging and Presence Protocol.
    XMPP = 64;
  }

  // The state of a network connection.
  enum ConnectionState {
    // The default connection state.
    CONNECTION_STATE_UNSPECIFIED = 0;

    // The port is listening for incoming connections.
    LISTENING = 1;

    // A connection has been established.
    ESTABLISHED = 2;

    // The connection is waiting for a timeout.
    TIME_WAIT = 3;

    // The connection is waiting for a connection termination request from the
    // local application.
    CLOSE_WAIT = 4;

    // The connection is closed.
    CLOSED = 5;

    // A connection request has been sent.
    SYN_SENT = 6;

    // A connection request has been received.
    SYN_RECEIVED = 7;

    // The connection is waiting for a connection termination request from the
    // remote host.
    FIN_WAIT1 = 8;

    // The connection is waiting for a connection termination request from the
    // local application.
    FIN_WAIT2 = 9;

    // The connection is waiting for an acknowledgment of the final connection
    // termination request.
    LAST_ACK = 10;
  }

  // The number of bytes sent.
  uint64 sent_bytes = 1;

  // The number of bytes received.
  uint64 received_bytes = 2;

  // The number of total bytes.
  int64 total_bytes = 27;

  // The number of packets sent.
  int64 sent_packets = 22;

  // The number of packets received.
  int64 received_packets = 23;

  // The duration of the session as the number of seconds and nanoseconds.
  // For seconds, network.session_duration.seconds, the type is a 64-bit
  // integer. For nanoseconds, network.session_duration.nanos, the type is a
  // 32-bit integer.
  google.protobuf.Duration session_duration = 13;

  // The ID of the network session.
  string session_id = 14;

  // The ID of the parent network session.
  string parent_session_id = 20;

  // The version of the application protocol. e.g. "1.1, 2.0"
  string application_protocol_version = 21;

  // Community ID network flow value.
  string community_id = 15;

  // The direction of network traffic.
  Direction direction = 12;

  // The IP protocol.
  IpProtocol ip_protocol = 3;

  // The application protocol.
  ApplicationProtocol application_protocol = 4;

  // FTP info.
  Ftp ftp = 5;

  // Email info for the sender/recipient.
  Email email = 6;

  // DNS info.
  Dns dns = 7;

  // DHCP info.
  Dhcp dhcp = 8;

  // HTTP info.
  Http http = 9;

  // TLS info.
  Tls tls = 10;

  // SMTP info.
  // Store fields specific to SMTP not covered by Email.
  Smtp smtp = 11;

  // Autonomous system number.
  string asn = 16;

  // DNS domain name.
  string dns_domain = 17;

  // Carrier identification.
  string carrier_name = 18;

  // Organization name (e.g Google).
  string organization_name = 19;

  // Associated human-readable IP subnet range (e.g. 10.1.2.0/24).
  string ip_subnet_range = 24;

  // Whether the IP address is a known proxy.
  bool is_proxy = 25;

  // Proxy information. Only set if is_proxy is true.
  ProxyInfo proxy_info = 26;

  // Output only. The state of the network connection.
  ConnectionState connection_state = 28
      [(google.api.field_behavior) = OUTPUT_ONLY];
}

// Proxy information.
message ProxyInfo {
  // Whether the IP address is anonymous.
  bool anonymous = 1;

  // Whether the IP address is an anonymous VPN.
  bool anonymous_vpn = 2;

  // Whether the IP address is a public proxy.
  bool public_proxy = 3;

  // Whether the IP address is a tor exit node.
  bool tor_exit_node = 4;

  // Whether the IP address is a smart DNS proxy.
  bool smart_dns_proxy = 5;

  // Whether the IP address is a hosting provider.
  bool hosting_provider = 6;

  // Whether the IP address is a VPN datacenter.
  bool vpn_datacenter = 7;

  // Whether the IP address is a residential proxy.
  bool residential_proxy = 8;

  // The name of the VPN service.
  string vpn_service_name = 9;

  // Whether the IP address is a proxy over VPN.
  bool proxy_over_vpn = 10;

  // Whether the IP address is a relay proxy.
  bool relay_proxy = 11;
}

// The Authentication extension captures details specific to authentication
// events.
// General guidelines for authentication events:
// * Details about the source of the authentication event (for example, client
//   IP or hostname), should be captured in principal. The principal may be
//   empty if we have no details about the source of the login.
// * Details about the target of the authentication event (for example, details
//   about the machine that is being logged into or logged out of) should be
//   captured in target.
// * Some authentication events may involve a third-party. For example, a user
//   logs into
//   a cloud service (for example, Chronicle) via their company's SSO (the
//   event is logged by their SSO solution). In this case, the principal
//   captures information about the user's device, the target captures details
//   about the cloud service they logged into, and the intermediary captures
//   details about the SSO solution.
message Authentication {
  // Authentication status, can be used to describe the status of authentication
  // for a user or particular credential.
  enum AuthenticationStatus {
    // The default authentication status.
    UNKNOWN_AUTHENTICATION_STATUS = 0;

    // The authentication method is in active state.
    ACTIVE = 1;

    // The authentication method is in suspended/disabled state.
    SUSPENDED = 2;

    // The authentication method has no active credentials.
    NO_ACTIVE_CREDENTIALS = 3;

    // The authentication method has been deleted.
    DELETED = 4;
  }
}

// A vulnerability.
message Vulnerability {
  // Severity of the vulnerability.
  enum Severity {
    // The default severity level.
    UNKNOWN_SEVERITY = 0;

    // Low severity.
    LOW = 1;

    // Medium severity.
    MEDIUM = 2;

    // High severity.
    HIGH = 3;

    // Critical severity.
    CRITICAL = 4;
  }

  // If the vulnerability is about a specific noun (e.g. executable),
  // then add it here.
  Noun about = 1;

  // Name of the vulnerability (e.g. "Unsupported OS Version detected").
  string name = 2;

  // Description of the vulnerability.
  string description = 3;

  // Vendor of scan that discovered vulnerability.
  string vendor = 13;

  // If the vulnerability was discovered during an asset scan, then this
  // field should be populated with the time the scan started.
  // This field can be left unset if the start time is not available or not
  // applicable.
  google.protobuf.Timestamp scan_start_time = 4;

  // If the vulnerability was discovered during an asset scan, then this field
  // should be populated with the time the scan ended.
  // This field can be left unset if the end time is not available or not
  // applicable.
  google.protobuf.Timestamp scan_end_time = 5;

  // Products that maintain a history of vuln scans should populate first_found
  // with the time that a scan first detected the vulnerability on this asset.
  google.protobuf.Timestamp first_found = 6;

  // Products that maintain a history of vuln scans should populate last_found
  // with the time that a scan last detected the vulnerability on this asset.
  google.protobuf.Timestamp last_found = 7;

  // The severity of the vulnerability.
  Severity severity = 8;

  // Vendor-specific severity
  string severity_details = 9;

  // CVSS Base Score in the range of 0.0 to 10.0.
  // Useful for sorting.
  float cvss_base_score = 10;

  // Vector of CVSS properties (e.g. "AV:L/AC:H/Au:N/C:N/I:P/A:C")
  // Can be linked to via:
  // <a
  // href="https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator">
  // https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator</a>
  string cvss_vector = 11;

  // Version of CVSS Vector/Score.
  string cvss_version = 12;

  // Common Vulnerabilities and Exposures Id.
  // <a
  // href="https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures">https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures</a>
  // <a
  // href="https://cve.mitre.org/about/faqs.html#what_is_cve_id">https://cve.mitre.org/about/faqs.html#what_is_cve_id</a>
  string cve_id = 14;

  // Common Vulnerabilities and Exposures Description.
  // <a
  // href="https://cve.mitre.org/about/faqs.html#what_is_cve_record">https://cve.mitre.org/about/faqs.html#what_is_cve_record</a>
  string cve_description = 15;

  // Vendor specific vulnerability id (e.g. Microsoft security bulletin id).
  string vendor_vulnerability_id = 16;

  // Vendor specific knowledge base article (e.g. "KBXXXXXX" from Microsoft).
  // <a
  // href="https://en.wikipedia.org/wiki/Microsoft_Knowledge_Base">https://en.wikipedia.org/wiki/Microsoft_Knowledge_Base</a>
  // <a
  // href="https://access.redhat.com/knowledgebase">https://access.redhat.com/knowledgebase</a>
  string vendor_knowledge_base_article_id = 17;
}

// FTP info.
message Ftp {
  // The FTP command.
  string command = 1;
}

// SMTP info.  See RFC 2821.
message Smtp {
  // The client's 'HELO'/'EHLO' string.
  string helo = 1;

  // The client's 'MAIL FROM' string.
  string mail_from = 2;

  // The client's 'RCPT TO' string(s).
  repeated string rcpt_to = 3;

  // The server's response(s) to the client.
  repeated string server_response = 4;

  // The message's path (extracted from the headers).
  string message_path = 5;

  // If the message was sent via a webmail client.
  bool is_webmail = 6;

  // If the connection switched to TLS.
  bool is_tls = 7;
}

// Email info.
message Email {
  // The 'from' address.
  string from = 1;

  // The 'reply to' address.
  string reply_to = 2;

  // A list of 'to' addresses.
  repeated string to = 3;

  // A list of 'cc' addresses.
  repeated string cc = 4;

  // A list of 'bcc' addresses.
  repeated string bcc = 5;

  // The mail (or message) ID.
  string mail_id = 6;

  // The subject line(s) of the email.
  repeated string subject = 7;

  // The envelope from address.
  // <a
  // href="https://en.wikipedia.org/wiki/Bounce_address">https://en.wikipedia.org/wiki/Bounce_address</a>
  string bounce_address = 8;
}

// Information about a process.
message Process {
  // The elevation type of the process's token.
  // See
  // https://learn.microsoft.com/en-us/windows/win32/api/winnt/ne-winnt-token_elevation_type
  enum TokenElevationType {
    // An undetermined token type.
    UNKNOWN = 0;

    // A full token with no privileges removed or groups disabled.
    TYPE_1 = 1;

    // An elevated token with no privileges removed or groups disabled. Used
    // when running as administrator.
    TYPE_2 = 2;

    // A limited token with administrative privileges removed and
    // administrative groups disabled.
    TYPE_3 = 3;
  }

  // The state of the process.
  // See
  // https://psutil.readthedocs.io/en/stable/#process-status-constants.
  enum State {
    // Undetermined state.
    STATE_UNSPECIFIED = 0;

    // Process is running or runnable.
    RUNNING = 1;

    // Process is waiting for an event.
    SLEEPING = 2;

    // Process is in uninterruptible sleep, typically I/O.
    DISK_SLEEP = 3;

    // Process is stopped.
    STOPPED = 4;

    // Process is stopped by debugger.
    TRACING_STOP = 5;

    // Process is terminated but not reaped by parent.
    ZOMBIE = 6;

    // Process is terminated.
    DEAD = 7;

    // Process is woken to be killed.
    WAKE_KILL = 8;

    // Process is waking from sleep.
    WAKING = 9;

    // Linux specific: process is parked.
    PARKED = 10;

    // Linux, macOS, and FreeBSD specific: process is idle.
    IDLE = 11;

    // FreeBSD specific: process is locked.
    LOCKED = 12;

    // FreeBSD specific: process is waiting.
    WAITING = 13;

    // NetBSD specific: process is suspended.
    SUSPENDED = 14;
  }

  // The process ID.
  // This field can be used as an entity indicator for process entities.
  string pid = 1;

  // The ID of the parent process.
  // Deprecated: use parent_process.pid instead.
  string parent_pid = 2 [deprecated = true];

  // Information about the parent process.
  Process parent_process = 7;

  // Information about the file in use by the process.
  File file = 3;

  // The command line command that created the process.
  // This field can be used as an entity indicator for process entities.
  string command_line = 4;

  // The command line history of the process.
  repeated string command_line_history = 9;

  // A product specific process id.
  string product_specific_process_id = 5;

  // A bit mask representing the level of access.
  uint64 access_mask = 8;

  // The Microsoft Windows integrity level relative ID (RID) of the process.
  uint64 integrity_level_rid = 11;

  // The effective user ID of the process.
  string euid = 12;

  // The real user ID of the process.
  string ruid = 13;

  // The effective group ID of the process.
  string egid = 14;

  // The real group ID of the process.
  string rgid = 15;

  // The identifier that points to the process group ID leader.
  string pgid = 16;

  // The process ID of the session leader process.
  string session_leader_pid = 17;

  // The teletype terminal which the command was executed within.
  string tty = 18;

  // The elevation type of the process on Microsoft Windows. This determines if
  // any privileges are removed when UAC is enabled.
  TokenElevationType token_elevation_type = 10;

  // A product specific id for the parent process.
  // Please use parent_process.product_specific_process_id instead.
  string product_specific_parent_process_id = 6 [deprecated = true];

  // This is used to determine if the process is an IPv6 process.
  bool ipv6 = 19;

  // The kernel time spent in the process.
  google.protobuf.Duration kernel_duration = 20;

  // The user time spent in the process.
  google.protobuf.Duration user_duration = 21;

  // The real time spent in the process. This is the sum of the kernel and user
  // time.
  google.protobuf.Duration real_duration = 22;

  // The state of the process.
  State state = 23;
}

// Stores information about an analytics metric used in a rule.
message AnalyticsMetadata {
  // Name of the analytic.
  string analytic = 1;
}

// A structure that holds the value and associated metadata for values
// extracted while producing a Finding.
message FindingVariable {
  // Type options for Finding variables.
  enum Type {
    // An unspecified variable type.
    TYPE_UNSPECIFIED = 0;

    // A variable coming from the match conditions.
    MATCH = 1;

    // A variable representing significant data that was found in the detection
    // logic.
    OUTCOME = 2;
  }

  // The type of the variable.
  Type type = 1;

  // The value in string form.
  string value = 2;

  // The UDM field path for the field which this value was derived from.
  // Example: `principal.user.username`
  string source_path = 3;

  // The typed value of the variable.
  oneof typed_value {
    // The value in boolean format.
    bool bool_val = 4;

    // The value in bytes format.
    bytes bytes_val = 5;

    // The value in double format.
    double double_val = 6;

    // The value in int64 format.
    int64 int64_val = 7;

    // The value in uint64 format.
    uint64 uint64_val = 8;

    // The value in string format.
    // Enum values are returned as strings.
    string string_val = 9;

    // The value in timestamp format.
    google.protobuf.Timestamp timestamp_time = 17;

    // Whether the value is null.
    bool null_val = 10;

    // The value in boolsequence format.
    BoolSequence bool_seq = 11;

    // The value in bytessequence format.
    BytesSequence bytes_seq = 12;

    // The value in doublesequence format.
    DoubleSequence double_seq = 13;

    // The value in int64sequence format.
    Int64Sequence int64_seq = 14;

    // The value in uint64sequence format.
    Uint64Sequence uint64_seq = 15;

    // The value in stringsequence format.
    StringSequence string_seq = 16;
  }
}

// Security related metadata for the event. A security result might be something
// like "virus detected and quarantined," "malicious connection blocked," or
// "sensitive data included in document foo.doc." Each security result, of which
// there may be more than one, may either pertain to the whole event, or to a
// specific object or device referenced in the event (e.g. a malicious file
// that was detected, or a sensitive document sent as an email attachment). For
// security results that apply to a particular object referenced in the event,
// the security_results message MUST contain details about the implicated object
// (such as process, user, IP, domain, URL, IP, or email address) in the about
// field. For security results that apply to the entire event (e.g. SPAM found
// in this email), the about field must remain empty.
message SecurityResult {
  // Represents different verdict types. Used to represent Mandiant
  // threat intelligence.
  enum VerdictResponse {
    // The default verdict response type.
    VERDICT_RESPONSE_UNSPECIFIED = 0;

    // VerdictResponse resulted a threat as malicious.
    MALICIOUS = 1;

    // VerdictResponse resulted a threat as benign.
    BENIGN = 2;
  }

  // Associations represents different metadata about malware and threat actors
  // involved with an IoC.
  message Association {
    // Represents different possible Association types. Can be threat or
    // malware. Used to represent Mandiant threat intelligence.
    enum AssociationType {
      // The default Association Type.
      ASSOCIATION_TYPE_UNSPECIFIED = 0;

      // Association type Threat actor.
      THREAT_ACTOR = 1;

      // Association type Malware.
      MALWARE = 2;
    }

    // Association Alias used to represent Mandiant Threat Intelligence.
    message AssociationAlias {
      // Name of the alias.
      string name = 1;

      // Name of the provider who gave the association's name.
      string company = 2;
    }

    // Unique association id generated by mandiant.
    string id = 1;

    // Country from which the threat actor/ malware is originated.
    repeated string country_code = 2;

    // Signifies the type of association.
    AssociationType type = 3;

    // Name of the threat actor/malware.
    string name = 4;

    // Human readable description about the association.
    string description = 5;

    // Role of the malware. Not applicable for threat actor.
    string role = 6;

    // Name of the country the threat originated from.
    string source_country = 7 [deprecated = true];

    // Different aliases of the threat actor given by different sources.
    repeated AssociationAlias alias = 8;

    // First time the threat actor was referenced or seen.
    google.protobuf.Timestamp first_reference_time = 9;

    // Last time the threat actor was referenced or seen.
    google.protobuf.Timestamp last_reference_time = 10;

    // List of industries the threat actor affects.
    repeated string industries_affected = 11;

    // List of associated threat actors for a malware. Not applicable for threat
    // actors.
    repeated Association associated_actors = 12;

    // Name of the country, the threat is originating from.
    Location region_code = 13;

    // Sponsor region of the threat actor.
    Location sponsor_region = 14;

    // Targeted regions.
    repeated Location targeted_regions = 15;

    // Tags.
    repeated string tags = 16;
  }

  // Deprecated.
  // Information about the threat intelligence source. These fields are used to
  // model Mandiant sources.
  message Source {
    // Name of the IoC source.
    string name = 1;

    // Count of responses where this IoC was marked benign.
    int32 benign_count = 2;

    // Count of responses where this IoC was marked malicious.
    int32 malicious_count = 3;

    // Quality of the IoC mapping extracted from the source.
    ProductConfidence quality = 4;

    // Total response count from this source.
    int32 response_count = 5;

    // Number of sources from which intelligence was extracted.
    int32 source_count = 6;

    // Different threat intelligence sources from which IoC info was extracted.
    repeated Source threat_intelligence_sources = 7;
  }

  // Deprecated.
  // MLVerdict result provided from threat providers, like Mandiant. These
  // fields are used to model Mandiant sources.
  message ProviderMLVerdict {
    // Source provider giving the ML verdict.
    string source_provider = 1;

    // Count of responses where this IoC was marked benign.
    int32 benign_count = 2;

    // Count of responses where this IoC was marked malicious.
    int32 malicious_count = 3;

    // Confidence score of the verdict.
    int32 confidence_score = 4;

    // List of mandiant sources from which the verdict was generated.
    repeated Source mandiant_sources = 5;

    // List of third-party sources from which the verdict was generated.
    repeated Source third_party_sources = 6;
  }

  // Verdict provided by the human analyst. These fields are used to model
  // Mandiant sources.
  message AnalystVerdict {
    // Confidence score of the verdict.
    int32 confidence_score = 1;

    // Timestamp at which the verdict was generated.
    google.protobuf.Timestamp verdict_time = 2;

    // Details of the verdict.
    VerdictResponse verdict_response = 3;
  }

  // Information about the threat intelligence source. These fields are used to
  // model Mandiant sources.
  message IoCStats {
    // Describes the source of the IoCStat.
    IoCStatsType ioc_stats_type = 1;

    // Name of first level IoC source, for example Mandiant or a third-party.
    string first_level_source = 2;

    // Name of the second-level IoC source, for example Crowdsourced Threat
    // Analysis or Knowledge Graph.
    string second_level_source = 3;

    // Count of responses where the IoC was identified as benign.
    int32 benign_count = 4;

    // Level of confidence in the IoC mapping extracted from the source.
    ProductConfidence quality = 5;

    // Count of responses where the IoC was identified as malicious.
    int32 malicious_count = 6;

    // Total number of response from the source.
    int32 response_count = 7;

    // Number of sources from which information was extracted.
    int32 source_count = 8;
  }

  // Type of IoCStat based on source.
  enum IoCStatsType {
    // IoCStat source is unidentified.
    UNSPECIFIED_IOC_STATS_TYPE = 0;

    // IoCStat is from a Mandiant Source.
    MANDIANT_SOURCES = 1;

    // IoCStat is from a third-party source.
    THIRD_PARTY_SOURCES = 2;

    // IoCStat is from a threat intelligence feed.
    THREAT_INTELLIGENCE_IOC_STATS = 3;
  }

  // Describes the threat verdict provided by human analysts and machine
  // learning models. These fields are used to model Mandiant sources.
  message VerdictInfo {
    // Number of sources from which intelligence was extracted.
    int32 source_count = 1;

    // Total response count across all sources.
    int32 response_count = 2;

    // Describes the near neighbor influence of the verdict.
    string neighbour_influence = 3;

    // Type of verdict.
    VerdictType verdict_type = 4;

    // Source provider giving the machine learning verdict.
    string source_provider = 5;

    // Count of responses where this IoC was marked as benign.
    int32 benign_count = 6;

    // Count of responses where this IoC was marked as malicious.
    int32 malicious_count = 7;

    // Confidence score of the verdict.
    int32 confidence_score = 8;

    // List of IoCStats from which the verdict was generated.
    repeated IoCStats ioc_stats = 9;

    // Timestamp when the verdict was generated.
    google.protobuf.Timestamp verdict_time = 11;

    // Details about the verdict.
    VerdictResponse verdict_response = 12;

    // Global customer count over the last 30 days
    int32 global_customer_count = 13;

    // Global hit count over the last 30 days.
    int32 global_hits_count = 14;

    // Whether one or more Mandiant incident response customers had this
    // indicator in their environment.
    bool pwn = 15;

    // Tags related to the verdict.
    string category_details = 16;

    // The timestamp of the first time a pwn was associated to this entity.
    google.protobuf.Timestamp pwn_first_tagged_time = 17;
  }

  // Category of the verdict.
  enum VerdictType {
    // Verdict category not specified.
    VERDICT_TYPE_UNSPECIFIED = 0;

    // MLVerdict result provided from threat providers, like Mandiant. These
    // fields are used to model Mandiant sources.
    PROVIDER_ML_VERDICT = 1;

    // Verdict provided by the human analyst. These fields are used to model
    // Mandiant sources.
    ANALYST_VERDICT = 2;
  }

  // SecurityCategory is used to standardize security categories across products
  // so one event is not categorized as "malware" and another as a "virus".
  enum SecurityCategory {
    // The default category.
    UNKNOWN_CATEGORY = 0;

    // Malware, spyware, rootkit.
    SOFTWARE_MALICIOUS = 10000;

    // Below the conviction threshold; probably bad.
    SOFTWARE_SUSPICIOUS = 10100;

    // Potentially Unwanted App (such as adware).
    SOFTWARE_PUA = 10200;

    // Includes C&C or network exploit.
    NETWORK_MALICIOUS = 20000;

    // Suspicious activity, such as potential reverse tunnel.
    NETWORK_SUSPICIOUS = 20100;

    // Non-security related: URL has category like gambling or porn.
    NETWORK_CATEGORIZED_CONTENT = 20200;

    // DoS, DDoS.
    NETWORK_DENIAL_OF_SERVICE = 20300;

    // Port scan detected by an IDS, probing of web app.
    NETWORK_RECON = 20400;

    // If we know this is a C&C channel.
    NETWORK_COMMAND_AND_CONTROL = 20500;

    // Unauthorized access attempted, including attempted access to files,
    // web services, processes, web objects, etc.
    ACL_VIOLATION = 30000;

    // Authentication failed (e.g. bad password or bad 2-factor authentication).
    AUTH_VIOLATION = 40000;

    // Exploit: For all manner of exploits including attempted overflows, bad
    // protocol encodings, ROP, SQL injection, etc. For both network and host-
    // based exploits.
    EXPLOIT = 50000;

    // DLP: Sensitive data transmission, copy to thumb drive.
    DATA_EXFILTRATION = 60000;

    // DLP: Sensitive data found at rest in a scan.
    DATA_AT_REST = 60100;

    // Attempt to destroy/delete data.
    DATA_DESTRUCTION = 60200;

    // TOR Exit Nodes.
    TOR_EXIT_NODE = 60300;

    // Spam email, message, etc.
    MAIL_SPAM = 70000;

    // Phishing email, chat messages, etc.
    MAIL_PHISHING = 70100;

    // Spoofed source email address, etc.
    MAIL_SPOOFING = 70200;

    // Security-related policy violation (e.g. firewall/proxy/HIPS rule
    // violated, NAC block action).
    POLICY_VIOLATION = 80000;

    // Threats which manipulate to break normal security procedures.
    SOCIAL_ENGINEERING = 90001;

    // Phishing pages, pops, https phishing etc.
    PHISHING = 90002;
  }

  // The type of alerting set up for a security result.
  enum AlertState {
    // The security result type is not known.
    UNSPECIFIED = 0;

    // The security result is not an alert.
    NOT_ALERTING = 1;

    // The security result is an alert.
    ALERTING = 2;
  }

  // Enum representing different possible actions taken by the product that
  // created the event.
  // Google SecOps classifies:
  // - ALLOW and ALLOW_WITH_MODIFICATION actions as "successful".
  // - BLOCK, QUARANTINE, FAIL, and CHALLENGE actions as "failed".
  //   This includes all corresponding metrics (for example, AUTH_ATTEMPTS_FAIL,
  //   FILE_EXECUTIONS_FAIL, RESOURCE_READ_FAIL, and so on).
  // - UNKNOWN_ACTION actions as neither "successful" nor "failed", because,
  //   for example, logs might not provide information whether a login event
  //   occurred but some kind of "unknown" error was issued nonetheless.
  enum Action {
    // The default action.
    UNKNOWN_ACTION = 0;

    // Allowed.
    ALLOW = 1;

    // Blocked.
    BLOCK = 2;

    // Strip, modify something
    // (e.g. File or email was disinfected or rewritten and still forwarded).
    ALLOW_WITH_MODIFICATION = 3;

    // Put somewhere for later analysis (does NOT imply block).
    QUARANTINE = 4;

    // Failed (e.g. the event was allowed but failed).
    FAIL = 5;

    // Challenged (e.g. the user was challenged by a Captcha, 2FA).
    CHALLENGE = 6;
  }

  // Defined by the product
  enum ProductSeverity {
    // The default severity level.
    UNKNOWN_SEVERITY = 0;

    // Info severity.
    INFORMATIONAL = 100;

    // An error.
    ERROR = 150;

    // No malicious result.
    NONE = 101;

    // Low-severity malicious result.
    LOW = 200;

    // Medium-severity malicious result.
    MEDIUM = 300;

    // High-severity malicious result.
    HIGH = 400;

    // Critical-severity malicious result.
    CRITICAL = 500;
  }

  // A level of confidence in the result.
  enum ProductConfidence {
    // The default confidence level.
    UNKNOWN_CONFIDENCE = 0;

    // Low confidence.
    LOW_CONFIDENCE = 200;

    // Medium confidence.
    MEDIUM_CONFIDENCE = 300;

    // High confidence.
    HIGH_CONFIDENCE = 400;
  }

  // A product priority level.
  enum ProductPriority {
    // Default priority level.
    UNKNOWN_PRIORITY = 0;

    // Low priority.
    LOW_PRIORITY = 200;

    // Medium priority.
    MEDIUM_PRIORITY = 300;

    // High priority.
    HIGH_PRIORITY = 400;
  }

  // Vendor-specific information about the status of a threat (ITW).
  enum ThreatStatus {
    // Default threat status
    THREAT_STATUS_UNSPECIFIED = 0;

    // Active threat.
    ACTIVE = 1;

    // Cleared threat.
    CLEARED = 2;

    // False positive.
    FALSE_POSITIVE = 3;
  }

  // Deprecated.
  // Encapsulates the threat verdict provided by human analysts and ML models.
  // These fields are used to model Mandiant sources.
  message Verdict {
    // Number of sources from which intelligence was extracted.
    int32 source_count = 1;

    // Total response count across all sources.
    int32 response_count = 2;

    // Describes the neighbour influence of the verdict.
    string neighbour_influence = 3;

    // ML Verdict provided by sources like Mandiant.
    ProviderMLVerdict verdict = 4;

    // Human analyst verdict provided by sources like Mandiant.
    AnalystVerdict analyst_verdict = 5;
  }

  // Different Types of threat collections currently supported.
  enum ThreatCollectionType {
    // Threat collection type is unspecified.
    THREAT_COLLECTION_TYPE_UNSPECIFIED = 0;

    // Threat collection type is campaign.
    CAMPAIGN = 1;

    // Threat collection type is report.
    REPORT = 2;
  }

  // Threat Collection that is either a threat campaign or a threat report.
  message ThreatCollectionItem {
    // The ID of the threat collection.
    string id = 1;

    // The type of threat collection (e.g., "campaign").
    ThreatCollectionType type = 2;

    // The name of the threat collection.
    repeated string alt_names = 3;
  }

  // If the security result is about a specific entity (Noun), add it here.
  // This field is not populated when the SecurityResult appears in a detection.
  Noun about = 1;

  // The security category.
  // This field is not populated when the SecurityResult appears in a detection.
  repeated SecurityCategory category = 2;

  // For vendor-specific categories. For web categorization, put type in here
  // such as "gambling" or "porn".
  // This field is not populated when the SecurityResult appears in a detection.
  repeated string category_details = 3;

  // A vendor-assigned classification common across multiple customers
  // (for example, "W32/File-A", "Slammer").
  // This field is not populated when the SecurityResult appears in a detection.
  string threat_name = 4;

  // The curated detection's rule set identifier.
  // (for example, "windows-threats")
  // This is primarily set in rule-generated detections and alerts.
  string rule_set = 29;

  // The curated detections rule set display name.
  // This is primarily set in rule-generated detections and alerts.
  string rule_set_display_name = 30;

  // The curated detection rule set category display name.
  // (for example, if rule_set_display_name is "CDIR SCC Enhanced Exfiltration",
  // the rule_set_category is "Cloud Threats").
  // This is primarily set in rule-generated detections and alerts.
  string ruleset_category_display_name = 41;

  // A vendor-specific ID for a rule, varying by observer type
  // (e.g. "08123", "5d2b44d0-5ef6-40f5-a704-47d61d3babbe").
  string rule_id = 16;

  // Name of the security rule
  // (e.g. "BlockInboundToOracle").
  string rule_name = 5;

  // Version of the security rule.
  // (e.g. "v1.1", "00001", "1604709794", "2020-11-16T23:04:19+00:00").
  // Note that rule versions are source-dependant and lexical ordering
  // should not be assumed.
  string rule_version = 20;

  // The type of security rule.
  string rule_type = 22;

  // Author of the security rule.
  // This field is not populated when the SecurityResult appears in a detection.
  string rule_author = 25;

  // A list of rule labels that can't be captured by the other fields
  // in security result
  // (e.g. "reference : AnotherRule", "contributor : John").
  // This is primarily set in rule-generated detections and alerts.
  repeated Label rule_labels = 26;

  // The alerting types of this security result.
  // This is primarily set for rule-generated detections and alerts.
  AlertState alert_state = 21;

  // An ordered list of values, that represent fields in detections for a
  // security finding. This list represents mapping of names of requested
  // entities to their values (the security result matched variables).
  //
  // For Collection SecurityResults, prefer variables instead.
  repeated Label detection_fields = 23;

  // A list of outcomes that represent the results of this security finding.
  // This list represents a mapping of names of the requested outcomes,
  // to a stringified version of their values.
  //
  // This is only populated when the SecurityResult appears in a detection.
  // This is deprecated. Use variables instead.
  repeated Label outcomes = 28 [deprecated = true];

  // A list of outcomes and match variables that represent the results of this
  // security finding. This list represents a mapping of names of the requested
  // outcomes or match variables, to their values.
  //
  // This is only populated when the SecurityResult appears in a detection.
  map<string, FindingVariable> variables = 44;

  // A short human-readable summary (e.g. "failed login occurred")
  string summary = 6;

  // A human-readable description (e.g. "user password was wrong").
  // This can be more detailed than the summary.
  string description = 7;

  // Actions taken for this event.
  // This field is not populated when the SecurityResult appears in a detection.
  repeated Action action = 8;

  // The detail of the action taken as provided by the vendor.
  // This field is not populated when the SecurityResult appears in a detection.
  string action_details = 19;

  // The severity of the result.
  ProductSeverity severity = 9;

  // The confidence level of the result as estimated by the product.
  // This field is not populated when the SecurityResult appears in a detection.
  ProductConfidence confidence = 10;

  // The priority of the result.
  // This field is not populated when the SecurityResult appears in a detection.
  ProductPriority priority = 11;

  // The risk score of the security result.
  float risk_score = 31;

  // The confidence score of the security result.
  // This field is not populated when the SecurityResult appears in a detection.
  float confidence_score = 42;

  // Stores metadata about each risk analytic metric the rule uses.
  // This field is not populated when the SecurityResult appears in a detection.
  repeated AnalyticsMetadata analytics_metadata = 43;

  // Vendor-specific severity.
  // This field is not populated when the SecurityResult appears in a detection.
  string severity_details = 12;

  // Additional detail with regards to the confidence of a security event as
  // estimated by the product vendor.
  // This field is not populated when the SecurityResult appears in a detection.
  string confidence_details = 13;

  // Vendor-specific information about the security result priority.
  // This field is not populated when the SecurityResult appears in a detection.
  string priority_details = 14;

  // URL that takes the user to the source product console for this event.
  // This field is not populated when the SecurityResult appears in a detection.
  string url_back_to_product = 15;

  // Vendor-specific ID for a threat.
  // This field is not populated when the SecurityResult appears in a detection.
  string threat_id = 17;

  // Vendor feed name for a threat indicator feed.
  // This field is not populated when the SecurityResult appears in a detection.
  string threat_feed_name = 27;

  // The attribute threat_id_namespace qualifies threat_id with an id namespace
  // to get an
  // unique id. The attribute threat_id by itself is not unique across Chronicle
  // as it is a vendor specific id.
  // This field is not populated when the SecurityResult appears in a detection.
  Id.Namespace threat_id_namespace = 24;

  // Current status of the threat
  // This field is not populated when the SecurityResult appears in a detection.
  ThreatStatus threat_status = 18;

  // MITRE ATT&CK details.
  // This field is not populated when the SecurityResult appears in a detection.
  AttackDetails attack_details = 32;

  // First time the IoC threat was discovered in the provider.
  // This field is not populated when the SecurityResult appears in a detection.
  google.protobuf.Timestamp first_discovered_time = 33;

  // Associations related to the threat.
  repeated Association associations = 34;

  // Campaigns using this IOC threat.
  // This is deprecated. Use threat_collections instead.
  repeated string campaigns = 35 [deprecated = true];

  // Reports that reference this IOC threat. These are the report IDs.
  // This is deprecated. Use threat_collections instead.
  repeated string reports = 46 [deprecated = true];

  // Verdict about the IoC from the provider.
  // This field is now deprecated. Use VerdictInfo instead.
  Verdict verdict = 36 [deprecated = true];

  // Last time the IoC threat was updated in the provider.
  // This field is not populated when the SecurityResult appears in a detection.
  google.protobuf.Timestamp last_updated_time = 37;

  // Verdict information about the IoC from the provider.
  // This field is not populated when the SecurityResult appears in a detection.
  repeated VerdictInfo verdict_info = 38;

  // GCTI threat verdict on the security result entity.
  // This field is not populated when the SecurityResult appears in a detection.
  ThreatVerdict threat_verdict = 39;

  // Last time the IoC was seen in the provider data.
  // This field is not populated when the SecurityResult appears in a detection.
  google.protobuf.Timestamp last_discovered_time = 40;

  // The depth of the detection chain.
  // Applies only to composite detections.
  int64 detection_depth = 47;

  // GTI collections associated with the security result.
  repeated ThreatCollectionItem threat_collections = 48;
}

// Metadata about a Microsoft Windows Portable Executable.
message PeFileMetadata {
  // Hash of PE imports.
  string import_hash = 1;
}

// Metadata about a file.
// Place metadata about different file types here, for example data
// from the Microsoft Windows VersionInfo block or digital signer details.
// Use a different sub-message per file type.
message FileMetadata {
  // Metadata for Microsoft Windows PE files.
  // Deprecate PeFileMetadata in favor of single File proto.
  PeFileMetadata pe = 1 [deprecated = true];
}

// Information about a file.
message File {
  // The file type, for example Microsoft Windows executable.
  enum FileType {
    // File type is UNSPECIFIED.
    FILE_TYPE_UNSPECIFIED = 0;

    // File type is PE_EXE.
    FILE_TYPE_PE_EXE = 1;

    // Although DLLs are actually portable executables, this value
    // enables the file type to be identified separately.
    // File type is PE_DLL.
    FILE_TYPE_PE_DLL = 2;

    // File type is MSI.
    FILE_TYPE_MSI = 3;

    // File type is NE_EXE.
    FILE_TYPE_NE_EXE = 10;

    // File type is NE_DLL.
    FILE_TYPE_NE_DLL = 11;

    // File type is DOS_EXE.
    FILE_TYPE_DOS_EXE = 20;

    // File type is DOS_COM.
    FILE_TYPE_DOS_COM = 21;

    // File type is COFF.
    FILE_TYPE_COFF = 30;

    // File type is ELF.
    FILE_TYPE_ELF = 31;

    // File type is LINUX_KERNEL.
    FILE_TYPE_LINUX_KERNEL = 32;

    // File type is RPM.
    FILE_TYPE_RPM = 33;

    // File type is LINUX.
    FILE_TYPE_LINUX = 34;

    // File type is MACH_O.
    FILE_TYPE_MACH_O = 35;

    // File type is JAVA_BYTECODE.
    FILE_TYPE_JAVA_BYTECODE = 36;

    // File type is DMG.
    FILE_TYPE_DMG = 37;

    // File type is DEB.
    FILE_TYPE_DEB = 38;

    // File type is PKG.
    FILE_TYPE_PKG = 39;

    // File type is PYC.
    FILE_TYPE_PYC = 40;

    // File type is LNK.
    FILE_TYPE_LNK = 50;

    // File type is DESKTOP_ENTRY.
    FILE_TYPE_DESKTOP_ENTRY = 51;

    // File type is JPEG.
    FILE_TYPE_JPEG = 100;

    // File type is TIFF.
    FILE_TYPE_TIFF = 101;

    // File type is GIF.
    FILE_TYPE_GIF = 102;

    // File type is PNG.
    FILE_TYPE_PNG = 103;

    // File type is BMP.
    FILE_TYPE_BMP = 104;

    // File type is GIMP.
    FILE_TYPE_GIMP = 105;

    // File type is Adobe InDesign.
    FILE_TYPE_IN_DESIGN = 106;

    // File type is PSD.
    // Adobe Photoshop.
    FILE_TYPE_PSD = 107;

    // File type is TARGA.
    FILE_TYPE_TARGA = 108;

    // File type is XWD.
    FILE_TYPE_XWD = 109;

    // File type is DIB.
    FILE_TYPE_DIB = 110;

    // File type is JNG.
    FILE_TYPE_JNG = 111;

    // File type is ICO.
    FILE_TYPE_ICO = 112;

    // File type is FPX.
    FILE_TYPE_FPX = 113;

    // File type is EPS.
    FILE_TYPE_EPS = 114;

    // File type is SVG.
    FILE_TYPE_SVG = 115;

    // File type is EMF.
    FILE_TYPE_EMF = 116;

    // File type is WEBP.
    FILE_TYPE_WEBP = 117;

    // File type is DWG.
    FILE_TYPE_DWG = 118;

    // File type is DXF.
    FILE_TYPE_DXF = 119;

    // File type is 3DS.
    FILE_TYPE_THREEDS = 120;

    // File type is OGG.
    FILE_TYPE_OGG = 150;

    // File type is FLC.
    FILE_TYPE_FLC = 151;

    // File type is FLI.
    FILE_TYPE_FLI = 152;

    // File type is MP3.
    FILE_TYPE_MP3 = 153;

    // File type is FLAC.
    FILE_TYPE_FLAC = 154;

    // File type is WAV.
    FILE_TYPE_WAV = 155;

    // File type is MIDI.
    FILE_TYPE_MIDI = 156;

    // File type is AVI.
    FILE_TYPE_AVI = 157;

    // File type is MPEG.
    FILE_TYPE_MPEG = 158;

    // File type is QUICKTIME.
    FILE_TYPE_QUICKTIME = 159;

    // File type is ASF.
    FILE_TYPE_ASF = 160;

    // File type is DIVX.
    FILE_TYPE_DIVX = 161;

    // File type is FLV.
    FILE_TYPE_FLV = 162;

    // File type is WMA.
    FILE_TYPE_WMA = 163;

    // File type is WMV.
    FILE_TYPE_WMV = 164;

    // File type is RM.
    // RealMedia type.
    FILE_TYPE_RM = 165;

    // File type is MOV.
    FILE_TYPE_MOV = 166;

    // File type is MP4.
    FILE_TYPE_MP4 = 167;

    // File type is T3GP.
    FILE_TYPE_T3GP = 168;

    // File type is WEBM.
    FILE_TYPE_WEBM = 169;

    // File type is MKV.
    FILE_TYPE_MKV = 170;

    // File type is PDF.
    FILE_TYPE_PDF = 200;

    // File type is PS.
    FILE_TYPE_PS = 201;

    // File type is DOC.
    FILE_TYPE_DOC = 202;

    // File type is DOCX.
    FILE_TYPE_DOCX = 203;

    // File type is PPT.
    FILE_TYPE_PPT = 204;

    // File type is PPTX.
    FILE_TYPE_PPTX = 205;

    // File type is XLS.
    FILE_TYPE_XLS = 206;

    // File type is XLSX.
    FILE_TYPE_XLSX = 207;

    // File type is RTF.
    FILE_TYPE_RTF = 208;

    // File type is PPSX.
    FILE_TYPE_PPSX = 209;

    // File type is ODP.
    FILE_TYPE_ODP = 250;

    // File type is ODS.
    FILE_TYPE_ODS = 251;

    // File type is ODT.
    FILE_TYPE_ODT = 252;

    // File type is HWP.
    FILE_TYPE_HWP = 253;

    // File type is GUL.
    FILE_TYPE_GUL = 254;

    // File type is ODF.
    FILE_TYPE_ODF = 255;

    // File type is ODG.
    FILE_TYPE_ODG = 256;

    // File type is ONE_NOTE.
    FILE_TYPE_ONE_NOTE = 257;

    // File type is OOXML.
    FILE_TYPE_OOXML = 258;

    // File type is SLK.
    FILE_TYPE_SLK = 259;

    // File type is EBOOK.
    FILE_TYPE_EBOOK = 260;

    // File type is LATEX.
    FILE_TYPE_LATEX = 261;

    // File type is TTF.
    FILE_TYPE_TTF = 262;

    // File type is EOT.
    FILE_TYPE_EOT = 263;

    // File type is WOFF.
    FILE_TYPE_WOFF = 264;

    // File type is CHM.
    FILE_TYPE_CHM = 265;

    // File type is ZIP.
    FILE_TYPE_ZIP = 300;

    // File type is GZIP.
    FILE_TYPE_GZIP = 301;

    // File type is BZIP.
    FILE_TYPE_BZIP = 302;

    // File type is RZIP.
    FILE_TYPE_RZIP = 303;

    // File type is DZIP.
    FILE_TYPE_DZIP = 304;

    // File type is SEVENZIP.
    FILE_TYPE_SEVENZIP = 305;

    // File type is CAB.
    FILE_TYPE_CAB = 306;

    // File type is JAR.
    FILE_TYPE_JAR = 307;

    // File type is RAR.
    FILE_TYPE_RAR = 308;

    // File type is MSCOMPRESS.
    FILE_TYPE_MSCOMPRESS = 309;

    // File type is ACE.
    FILE_TYPE_ACE = 310;

    // File type is ARC.
    FILE_TYPE_ARC = 311;

    // File type is ARJ.
    FILE_TYPE_ARJ = 312;

    // File type is ASD.
    FILE_TYPE_ASD = 313;

    // File type is BLACKHOLE.
    FILE_TYPE_BLACKHOLE = 314;

    // File type is KGB.
    FILE_TYPE_KGB = 315;

    // File type is ZLIB.
    FILE_TYPE_ZLIB = 316;

    // File type is TAR.
    FILE_TYPE_TAR = 317;

    // File type is ZST.
    FILE_TYPE_ZST = 318;

    // File type is LZFSE.
    FILE_TYPE_LZFSE = 319;

    // File type is PYTHON_WHL.
    FILE_TYPE_PYTHON_WHL = 320;

    // File type is PYTHON_PKG.
    FILE_TYPE_PYTHON_PKG = 321;

    // File type is MSIX, new Windows app package format.
    FILE_TYPE_MSIX = 322;

    // File type is TEXT.
    FILE_TYPE_TEXT = 400;

    // File type is SCRIPT.
    FILE_TYPE_SCRIPT = 401;

    // File type is PHP.
    FILE_TYPE_PHP = 402;

    // File type is PYTHON.
    FILE_TYPE_PYTHON = 403;

    // File type is PERL.
    FILE_TYPE_PERL = 404;

    // File type is RUBY.
    FILE_TYPE_RUBY = 405;

    // File type is C.
    FILE_TYPE_C = 406;

    // File type is CPP.
    FILE_TYPE_CPP = 407;

    // File type is JAVA.
    FILE_TYPE_JAVA = 408;

    // File type is SHELLSCRIPT.
    FILE_TYPE_SHELLSCRIPT = 409;

    // File type is PASCAL.
    FILE_TYPE_PASCAL = 410;

    // File type is AWK.
    FILE_TYPE_AWK = 411;

    // File type is DYALOG.
    FILE_TYPE_DYALOG = 412;

    // File type is FORTRAN.
    FILE_TYPE_FORTRAN = 413;

    // File type is JAVASCRIPT.
    FILE_TYPE_JAVASCRIPT = 414;

    // File type is POWERSHELL.
    FILE_TYPE_POWERSHELL = 415;

    // File type is VBA.
    FILE_TYPE_VBA = 416;

    // File type is M4.
    FILE_TYPE_M4 = 417;

    // File type is OBJETIVEC.
    FILE_TYPE_OBJETIVEC = 418;

    // File type is JMOD.
    FILE_TYPE_JMOD = 419;

    // File type is MAKEFILE.
    FILE_TYPE_MAKEFILE = 420;

    // File type is INI.
    FILE_TYPE_INI = 421;

    // File type is CLJ.
    FILE_TYPE_CLJ = 422;

    // File type is PDB.
    FILE_TYPE_PDB = 425;

    // File type is SQL.
    FILE_TYPE_SQL = 426;

    // File type is NEKO.
    FILE_TYPE_NEKO = 427;

    // File type is WER.
    FILE_TYPE_WER = 428;

    // File type is GOLANG.
    FILE_TYPE_GOLANG = 429;

    // File type is M3U.
    FILE_TYPE_M3U = 430;

    // File type is BAT, Windows .bat/.cmd (old files are tagged as
    // SHELLSCRIPT).
    FILE_TYPE_BAT = 431;

    // File type is MSC, Microsoft Management Console (MMC).
    FILE_TYPE_MSC = 432;

    // File type is RDP, Microsoft Remote Desktop Protocol (RDP) file.
    FILE_TYPE_RDP = 433;

    // File type is SYMBIAN.
    FILE_TYPE_SYMBIAN = 500;

    // File type is PALMOS.
    FILE_TYPE_PALMOS = 501;

    // File type is WINCE.
    FILE_TYPE_WINCE = 502;

    // File type is ANDROID.
    FILE_TYPE_ANDROID = 503;

    // File type is IPHONE.
    FILE_TYPE_IPHONE = 504;

    // File type is HTML.
    FILE_TYPE_HTML = 600;

    // File type is XML.
    FILE_TYPE_XML = 601;

    // File type is SWF.
    FILE_TYPE_SWF = 602;

    // File type is FLA.
    FILE_TYPE_FLA = 603;

    // File type is COOKIE.
    FILE_TYPE_COOKIE = 604;

    // File type is TORRENT.
    FILE_TYPE_TORRENT = 605;

    // File type is EMAIL_TYPE.
    FILE_TYPE_EMAIL_TYPE = 606;

    // File type is OUTLOOK.
    FILE_TYPE_OUTLOOK = 607;

    // File type is SGML.
    FILE_TYPE_SGML = 608;

    // File type is JSON.
    FILE_TYPE_JSON = 609;

    // File type is CSV.
    FILE_TYPE_CSV = 610;

    // File type is HTA (HTML Application).
    FILE_TYPE_HTA = 611;

    // File type is MSHTML .url.
    FILE_TYPE_INTERNET_SHORTCUT = 612;

    // File type is CAP.
    FILE_TYPE_CAP = 700;

    // File type is ISOIMAGE.
    FILE_TYPE_ISOIMAGE = 800;

    // File type is SQUASHFS.
    FILE_TYPE_SQUASHFS = 801;

    // File type is VHD.
    FILE_TYPE_VHD = 802;

    // File type is APPLE.
    FILE_TYPE_APPLE = 1000;

    // File type is MACINTOSH.
    FILE_TYPE_MACINTOSH = 1001;

    // File type is APPLESINGLE.
    FILE_TYPE_APPLESINGLE = 1002;

    // File type is APPLEDOUBLE.
    FILE_TYPE_APPLEDOUBLE = 1003;

    // File type is MACINTOSH_HFS.
    FILE_TYPE_MACINTOSH_HFS = 1004;

    // File type is APPLE_PLIST.
    FILE_TYPE_APPLE_PLIST = 1005;

    // File type is MACINTOSH_LIB.
    FILE_TYPE_MACINTOSH_LIB = 1006;

    // File type is APPLESCRIPT.
    FILE_TYPE_APPLESCRIPT = 1007;

    // File type is APPLESCRIPT_COMPILED .
    FILE_TYPE_APPLESCRIPT_COMPILED = 1008;

    // File type is CRX.
    FILE_TYPE_CRX = 1100;

    // File type is XPI.
    FILE_TYPE_XPI = 1101;

    // File type is ROM.
    FILE_TYPE_ROM = 1200;

    // File type is IPS.
    FILE_TYPE_IPS = 1201;

    // File type is PEM.
    FILE_TYPE_PEM = 1300;

    // File type is PGP.
    FILE_TYPE_PGP = 1301;

    // File type is CRT.
    FILE_TYPE_CRT = 1302;
  }

  // The SHA256 hash of the file, as a hex-encoded string.
  // This field can be used as an entity indicator for file entities.
  string sha256 = 1;

  // The MD5 hash of the file, as a hex-encoded string.
  // This field can be used as an entity indicator for file entities.
  string md5 = 2;

  // The SHA1 hash of the file, as a hex-encoded string.
  // This field can be used as an entity indicator for file entities.
  string sha1 = 3;

  // The size of the file in bytes.
  uint64 size = 4;

  // The full path identifying the location of the file on the system.
  // This field can be used as an entity indicator for file entities.
  string full_path = 5;

  // The MIME (Multipurpose Internet Mail Extensions) type of the file,
  // for example "PE", "PDF", or "powershell script".
  string mime_type = 6;

  // Metadata associated with the file.
  // Deprecate FileMetadata in favor of using fields in File.
  FileMetadata file_metadata = 7 [deprecated = true];

  // Google Cloud Threat Intelligence (GCTI) security result for the file
  // including threat context and detection metadata.
  SecurityResult security_result = 36;

  // Metadata about the Portable Executable (PE) file.
  FileMetadataPE pe_file = 8;

  // Ssdeep of the file
  string ssdeep = 9;

  // Vhash of the file.
  string vhash = 10;

  // Deprecated. Use authentihash instead.
  string ahash = 11 [deprecated = true];

  // Authentihash of the file.
  string authentihash = 20;

  // SymHash of the file. Used for Mach-O (e.g. MacOS) binaries, to identify
  // similar files based on their symbol table.
  string symhash = 41;

  // Metadata about the prefetch file.
  PrefetchFileMetadata prefetch_file_metadata = 43;

  // FileType field.
  FileType file_type = 12;

  // Capabilities tags.
  repeated string capabilities_tags = 13;

  // Names fields.
  repeated string names = 14;

  // Tags for the file.
  repeated string tags = 27;

  // Timestamp when the file was last updated.
  google.protobuf.Timestamp last_modification_time = 15;

  // Timestamp when the file was created.
  google.protobuf.Timestamp create_time = 39;

  // Timestamp when the file was accessed.
  google.protobuf.Timestamp last_access_time = 40;

  // Prevalence of the file hash in the customer's environment.
  Prevalence prevalence = 16;

  // Timestamp the file was first seen in the customer's environment.
  google.protobuf.Timestamp first_seen_time = 17;

  // Timestamp the file was last seen in the customer's environment.
  google.protobuf.Timestamp last_seen_time = 18;

  // The mode of the file. A bit string indicating the permissions and
  // privileges of the file.
  uint64 stat_mode = 21;

  // The file identifier. Unique identifier of object within a file system.
  uint64 stat_inode = 22;

  // The file system identifier to which the object belongs.
  uint64 stat_dev = 23;

  // Number of links to file.
  uint64 stat_nlink = 24;

  // User defined flags for file.
  uint32 stat_flags = 25;

  // Timestamp the file was last analysed.
  google.protobuf.Timestamp last_analysis_time = 26;

  // Embedded urls found in the file.
  repeated string embedded_urls = 28;

  // Embedded domains found in the file.
  repeated string embedded_domains = 29;

  // Embedded IP addresses found in the file.
  repeated string embedded_ips = 30;

  // Exif metadata from different file formats extracted by exiftool.
  ExifInfo exif_info = 31;

  // File signature information extracted from different tools.
  SignatureInfo signature_info = 32;

  // Information about the PDF file structure.
  PDFInfo pdf_info = 33;

  // First submission time of the file.
  google.protobuf.Timestamp first_submission_time = 34;

  // Last submission time of the file.
  google.protobuf.Timestamp last_submission_time = 35;

  // Icon's relevant hashes.
  Favicon main_icon = 37;

  // NTFS metadata.
  NtfsFileMetadata ntfs = 38;

  // Windows AppCompatCache (Application Compatibility) metadata.
  AppCompatMetadata app_compat_cache = 42;
}

// NTFS-specific file metadata.
message NtfsFileMetadata {
  // NTFS MFT entry changed timestamp.
  google.protobuf.Timestamp change_time = 1;

  // NTFS $FILE_NAME attribute created timestamp.
  google.protobuf.Timestamp filename_create_time = 2;

  // NTFS $FILE_NAME attribute modified timestamp.
  google.protobuf.Timestamp filename_modify_time = 3;

  // NTFS $FILE_NAME attribute accessed timestamp.
  google.protobuf.Timestamp filename_access_time = 4;

  // NTFS $FILE_NAME attribute changed timestamp.
  google.protobuf.Timestamp filename_change_time = 5;

  // NTFS USN journal.
  repeated UsnJournal usn_journal = 6;
}

// Windows Prefetch file metadata.
message PrefetchFileMetadata {
  // The number of times the application has been run.
  int64 run_count = 1;

  // A hash of the executable path used to identify the prefetch file.
  string prefetch_hash = 2;
}

// Information from the NTFS USN Journal.
message UsnJournal {
  // File attributes from the USN record (e.g., "READ_ONLY, HIDDEN"). See
  // https://learn.microsoft.com/en-us/windows/win32/fileio/file-attribute-constants
  // for more information about the attributes.
  enum Attribute {
    // Unspecified attribute.
    ATTRIBUTE_UNSPECIFIED = 0;

    // A file that is read-only.
    READ_ONLY = 1;

    // The file or directory is hidden.
    HIDDEN = 2;

    // A file or directory that the operating system uses.
    SYSTEM = 3;

    // Archive file or directory.
    ARCHIVE = 4;

    // A file or directory that is compressed.
    COMPRESSED = 5;

    // A file or directory that is encrypted.
    ENCRYPTED = 6;

    // The handle that identifies the directory.
    DIRECTORY = 7;

    // Reserved for system use.
    DEVICE = 8;

    // A file that does not have other attributes set.
    NORMAL = 9;

    // A file that is being used for temporary storage.
    TEMPORARY = 10;

    // A file that is a sparse file.
    SPARSE_FILE = 11;

    // A file or directory that has an associated reparse point.
    REPARSE_POINT = 12;

    // The data of a file is not available immediately.
    OFFLINE = 13;

    // The file or directory is not to be indexed.
    NON_CONTENT_INDEXED = 14;

    // The directory or user data stream is configured with integrity.
    INTEGRITY_STREAM = 15;

    // Reserved for system use.
    VIRTUAL = 16;

    // The user data stream not to be read by the background data integrity
    // scanner.
    NO_SCRUB_DATA = 17;

    // A file or directory with extended attributes.
    EA = 18;

    // The file or directory should be kept fully present locally.
    PINNED = 19;

    // The file or directory should not be kept fully present locally.
    UNPINNED = 20;

    // The file or directory has no physical representation on the local
    // system.
    RECALL_ON_OPEN = 21;

    // The file or directory is not fully present locally.
    RECALL_ON_DATA_ACCESS = 22;
  }

  // The reason for the USN journal entry.
  enum Reason {
    // Unspecified reason.
    REASON_UNSPECIFIED = 0;

    // Data overwrite reason.
    DATA_OVERWRITE = 1;

    // Data extend reason.
    DATA_EXTEND = 2;

    // Data truncation reason.
    DATA_TRUNCATION = 3;

    // Named data overwrite reason.
    NAMED_DATA_OVERWRITE = 4;

    // Named data extend reason.
    NAMED_DATA_EXTEND = 5;

    // Named data truncation reason.
    NAMED_DATA_TRUNCATION = 6;

    // File create reason.
    FILE_CREATE = 7;

    // File delete reason.
    FILE_DELETE = 8;

    // EA change reason.
    EA_CHANGE = 9;

    // Security change reason.
    SECURITY_CHANGE = 10;

    // Rename old name reason.
    RENAME_OLD_NAME = 11;

    // Rename new name reason.
    RENAME_NEW_NAME = 12;

    // Indexable change reason.
    INDEXABLE_CHANGE = 13;

    // Basic info change reason.
    BASIC_INFO_CHANGE = 14;

    // Hard link change reason.
    HARD_LINK_CHANGE = 15;

    // Compression change reason.
    COMPRESSION_CHANGE = 16;

    // Encryption change reason.
    ENCRYPTION_CHANGE = 17;

    // Object ID change reason.
    OBJECT_ID_CHANGE = 18;

    // Reparse point change reason.
    REPARSE_POINT_CHANGE = 19;

    // Stream change reason.
    STREAM_CHANGE = 20;

    // Transacted change reason.
    TRANSACTED_CHANGE = 21;

    // Close reason.
    CLOSE = 22;
  }

  // File attributes flags from the USN record (e.g., "0x20").
  string attributes_flag = 1;

  // Deprecated: Use file_attributes instead.
  // File attributes from the USN record.
  Attribute attributes = 2 [deprecated = true];

  // File attributes from the USN record.
  repeated Attribute file_attributes = 5;

  // Indicates whether the file is allocated in the Master File Table (MFT).
  bool allocated = 3;

  // Human-readable string describing the reason for the USN journal entry
  // (e.g., "USN_REASON_FILE_CREATE").
  Reason reason = 4;
}

// Windows AppCompatCache (Application Compatibility) metadata.
message AppCompatMetadata {
  // Indicates the chronological order in which the entry was added to the
  // cache.
  int32 sequence = 1;

  // Indicates whether the file associated with the entry was executed.
  bool executed = 2;

  // Indicates which registry Control Set the AppCompatCache data belongs to
  // (e.g., "ControlSet001").
  string control_set = 3;
}

// Metadata about the Portable Executable (PE) file.
message FileMetadataPE {
  // Imphash of the file.
  string imphash = 1;

  // info.pe-entry-point.
  int64 entry_point = 2;

  // info.exiftool.EntryPoint.
  int64 entry_point_exiftool = 9;

  // info.pe-timestamp.
  google.protobuf.Timestamp compilation_time = 10;

  // info.exiftool.TimeStamp.
  google.protobuf.Timestamp compilation_exiftool_time = 11;

  // FilemetadataSection fields.
  repeated FileMetadataSection section = 3;

  // FilemetadataImports fields.
  repeated FileMetadataImports imports = 4;

  // FilemetadataPeResourceInfo fields.
  repeated FileMetadataPeResourceInfo resource = 5;

  // Deprecated: use resources_type_count_str.
  repeated StringToInt64MapEntry resources_type_count = 6 [deprecated = true];

  // Deprecated: use resources_language_count_str.
  repeated StringToInt64MapEntry resources_language_count = 7
      [deprecated = true];

  // Number of resources by resource type.
  // Example: RT_ICON: 10, RT_DIALOG: 5
  repeated Label resources_type_count_str = 12;

  // Number of resources by language.
  // Example: NEUTRAL: 20, ENGLISH US: 10
  repeated Label resources_language_count_str = 13;

  // FilemetadataSignatureInfo field.
  // deprecated, user File.signature_info instead.
  FileMetadataSignatureInfo signature_info = 8 [deprecated = true];
}

// File metadata for PE resource.
message FileMetadataPeResourceInfo {
  // SHA256_hex field..
  string sha256_hex = 1;

  // Type of resource content, as identified by the magic Python module.
  string filetype_magic = 2;

  // Human-readable version of the language and sublanguage identifiers, as
  // defined in the Microsoft Windows PE specification.
  // Examples:
  // | Language     | Sublanguage        | Field value |
  // | LANG_NEUTRAL | SUBLANG_NEUTRAL    | NEUTRAL     |
  // | LANG_FRENCH  | -                  | FRENCH      |
  // | LANG_ENGLISH | SUBLANG_ENGLISH US | ENGLISH US  |
  string language_code = 4;

  // Entropy of the resource.
  double entropy = 5;

  // File type.
  // Note that this value may not match any of the well-known type identifiers
  // defined in the ResourceType enum.
  string file_type = 6;
}

// File signature information extracted from different tools.
message SignatureInfo {
  // Signature information extracted from the sigcheck tool.
  FileMetadataSignatureInfo sigcheck = 1;

  // Signature information extracted from the codesign utility.
  FileMetadataCodesign codesign = 2;
}

// Signature information.
message FileMetadataSignatureInfo {
  // Status of the certificate.
  // Valid values are "Signed", "Unsigned" or a description of the certificate
  // anomaly, if found.
  string verification_message = 1;

  // True if verification_message == "Signed"
  bool verified = 2;

  // Deprecated: use signers field.
  repeated string signer = 3 [deprecated = true];

  // File metadata signer information.
  // The order of the signers matters. Each element is a higher level
  // authority, being the last the root authority.
  repeated SignerInfo signers = 4;

  // List of certificates.
  repeated X509 x509 = 5;
}

// File metadata related to the signer information.
message SignerInfo {
  // Common name of the signers/certificate.
  // The order of the signers matters. Each element is a higher level
  // authority, the last being the root authority.
  optional string name = 1;

  // It can say "Valid" or state the problem with the certificate if any (e.g.
  // "This certificate or one of the certificates in the certificate chain is
  // not time valid.").
  optional string status = 2;

  // Indicates which situations the certificate is valid for (e.g. "Code
  // Signing").
  optional string valid_usage = 3;

  // Company that issued the certificate.
  optional string cert_issuer = 4;
}

// File metadata from the codesign utility.
message FileMetadataCodesign {
  // Code sign identifier.
  string id = 1;

  // Code sign format.
  string format = 2;

  // Code sign timestamp
  google.protobuf.Timestamp compilation_time = 3;

  // The assigned team identifier of the developer who signed the application.
  string team_id = 4;
}

// File certificate.
message X509 {
  // Certificate name.
  string name = 1;

  // Certificate algorithm.
  string algorithm = 2;

  // Certificate thumbprint.
  string thumbprint = 3;

  // Issuer of the certificate.
  string cert_issuer = 4;

  // Certificate serial number.
  string serial_number = 5;
}

// Information about the PDF file structure. See
// <a
// href="https://developers.virustotal.com/reference/pdf_info">https://developers.virustotal.com/reference/pdf_info</a>
message PDFInfo {
  // Number of /JS tags found in the PDF file. Should be the same as
  // javascript field in normal scenarios.
  int64 js = 1;

  // Number of /JavaScript tags found in the PDF file. Should be the same as
  // the js field in normal scenarios.
  int64 javascript = 2;

  // Number of /Launch tags found in the PDF file.
  int64 launch_action_count = 3;

  // Number of object streams.
  int64 object_stream_count = 4;

  // Number of object definitions (endobj keyword).
  int64 endobj_count = 5;

  // PDF version.
  string header = 6;

  // Number of /AcroForm tags found in the PDF.
  int64 acroform = 7;

  // Number of /AA tags found in the PDF.
  int64 autoaction = 8;

  // Number of /EmbeddedFile tags found in the PDF.
  int64 embedded_file = 9;

  // Whether the document is encrypted or not. This is defined by the /Encrypt
  // tag.
  int64 encrypted = 10;

  // Number of /RichMedia tags found in the PDF.
  int64 flash = 11;

  // Number of /JBIG2Decode tags found in the PDF.
  int64 jbig2_compression = 12;

  // Number of objects definitions (obj keyword).
  int64 obj_count = 13;

  // Number of defined stream objects (stream keyword).
  int64 endstream_count = 14;

  // Number of pages in the PDF.
  int64 page_count = 15;

  // Number of defined stream objects (stream keyword).
  int64 stream_count = 16;

  // Number of /OpenAction tags found in the PDF.
  int64 openaction = 17;

  // Number of startxref keywords in the PDF.
  int64 startxref = 18;

  // Number of colors expressed with more than 3 bytes (CVE-2009-3459).
  int64 suspicious_colors = 19;

  // Number of trailer keywords in the PDF.
  int64 trailer = 20;

  // Number of \XFA tags found in the PDF.
  int64 xfa = 21;

  // Number of xref keywords in the PDF.
  int64 xref = 22;
}

message StringToInt64MapEntry {
  // Key field.
  optional string key = 1;

  // Value field.
  optional int64 value = 2;
}

// File metadata section.
message FileMetadataSection {
  // Name of the section.
  string name = 1;

  // Entropy of the section.
  double entropy = 2;

  // Raw file size in bytes.
  int64 raw_size_bytes = 3;

  // Virtual file size in bytes.
  int64 virtual_size_bytes = 4;

  // MD5 hex of the file.
  string md5_hex = 5;
}

// File metadata imports.
message FileMetadataImports {
  // Library field.
  string library = 1;

  // Function field.
  repeated string functions = 2;
}

// Exif information.
message ExifInfo {
  // original file name.
  string original_file = 1;

  // product name.
  string product = 2;

  // company name.
  string company = 3;

  // description of a file.
  string file_description = 4;

  // entry point.
  int64 entry_point = 5;

  // Compilation time.
  google.protobuf.Timestamp compilation_time = 6;
}

// The prevalence of a resource within the customer's environment.
// This measures how common it is for assets to access the resource.
message Prevalence {
  // The maximum number of assets per day accessing the resource over the
  // trailing day_count days.
  int32 rolling_max = 1;

  // The number of days over which rolling_max is calculated.
  int32 day_count = 2;

  // The maximum number of assets per day accessing the domain along with
  // sub-domains over the trailing day_count days. This field is only valid for
  // domains.
  int32 rolling_max_sub_domains = 3;

  // The max prevalence score in a day interval window.
  int32 day_max = 4;

  // The max prevalence score in a day interval window across sub-domains. This
  // field is only valid for domains.
  int32 day_max_sub_domains = 5;
}

// DNS information.
message Dns {
  // DNS Questions. See RFC1035, section 4.1.2.
  message Question {
    // The domain name.
    string name = 1;

    // The code specifying the type of the query.
    uint32 type = 2;

    // The code specifying the class of the query.
    uint32 class = 3;

    // The prevalence of the domain within the customer's environment.
    Prevalence prevalence = 4;
  }

  // DNS Resource Records. See RFC1035, section 4.1.3.
  message ResourceRecord {
    // The name of the owner of the resource record.
    string name = 1;

    // The code specifying the type of the resource record.
    uint32 type = 2;

    // The code specifying the class of the resource record.
    uint32 class = 3;

    // The time interval for which the resource record can be cached before the
    // source of the information should again be queried.
    uint32 ttl = 4;

    // The payload or response to the DNS question for all responses encoded in
    // UTF-8 format
    string data = 5;

    // The raw bytes of any non-UTF8 strings that might be included as part of a
    // DNS response.
    bytes binary_data = 6;
  }

  // DNS query id.
  uint32 id = 6;

  // Set to true if the event is a DNS response. See QR field from RFC1035.
  bool response = 7;

  // The DNS OpCode used to specify the type of DNS query
  // (for example, QUERY, IQUERY, or STATUS).
  uint32 opcode = 8;

  // Other DNS header flags. See RFC1035, section 4.1.1.
  bool authoritative = 9;

  // Whether the DNS response was truncated.
  bool truncated = 10;

  // Whether a recursive DNS lookup is desired.
  bool recursion_desired = 11;

  // Whether a recursive DNS lookup is available.
  bool recursion_available = 12;

  // Response code. See RCODE from RFC1035.
  uint32 response_code = 13;

  // A list of domain protocol message questions.
  repeated Question questions = 1;

  // A list of answers to the domain name query.
  repeated ResourceRecord answers = 2;

  // A list of domain name servers which verified the answers to the domain name
  // queries.
  repeated ResourceRecord authority = 3;

  // A list of additional domain name servers that can be used to verify the
  // answer to the domain.
  repeated ResourceRecord additional = 4;
}

// DHCP information.
message Dhcp {
  // BOOTP op code. See RFC951, section 3.
  enum OpCode {
    // Default opcode.
    UNKNOWN_OPCODE = 0;

    // Request.
    BOOTREQUEST = 1;

    // Reply.
    BOOTREPLY = 2;
  }

  // DHCP options.
  message Option {
    // Code. See RFC1533.
    uint32 code = 1;

    // Data.
    bytes data = 2;
  }

  // DHCP message type. See RFC2131, section 3.1.
  enum MessageType {
    // Default message type.
    UNKNOWN_MESSAGE_TYPE = 0;

    // DHCPDISCOVER.
    DISCOVER = 1;

    // DHCPOFFER.
    OFFER = 2;

    // DHCPREQUEST.
    REQUEST = 3;

    // DHCPDECLINE.
    DECLINE = 4;

    // DHCPACK.
    ACK = 5;

    // DHCPNAK.
    NAK = 6;

    // DHCPRELEASE.
    RELEASE = 7;

    // DHCPINFORM.
    INFORM = 8;

    // Microsoft Windows DHCP "lease deleted".
    WIN_DELETED = 100;

    // Microsoft Windows DHCP "lease expired".
    WIN_EXPIRED = 101;
  }

  // The BOOTP op code.
  OpCode opcode = 1;

  // Hardware address type.
  uint32 htype = 2;

  // Hardware address length.
  uint32 hlen = 3;

  // Hardware ops.
  uint32 hops = 4;

  // Transaction ID.
  uint32 transaction_id = 5;

  // Seconds elapsed since client began address acquisition/renewal process.
  uint32 seconds = 6;

  // Flags.
  uint32 flags = 7;

  // Client IP address (ciaddr).
  string ciaddr = 8;

  // Your IP address (yiaddr).
  string yiaddr = 9;

  // IP address of the next bootstrap server.
  string siaddr = 10;

  // Relay agent IP address (giaddr).
  string giaddr = 11;

  // Client hardware address (chaddr).
  string chaddr = 12;

  // Server name that the client wishes to boot from.
  string sname = 13;

  // Boot image filename.
  string file = 14;

  // List of DHCP options.
  repeated Option options = 15;

  // DHCP message type.
  MessageType type = 16;

  // Lease time in seconds. See RFC2132, section 9.2.
  uint32 lease_time_seconds = 17;

  // Client hostname. See RFC2132, section 3.14.
  string client_hostname = 18;

  // Client identifier. See RFC2132, section 9.14.
  // Note: Make sure to update the client_identifier_string field as well if you
  // update this field.
  bytes client_identifier = 19;

  // Requested IP address. See RFC2132, section 9.1.
  string requested_address = 20;

  // Client identifier as string. See RFC2132, section 9.14.
  // This field holds the string value of the client_identifier.
  string client_identifier_string = 21;
}

// Certificate information
message Certificate {
  // Certificate version.
  string version = 1;

  // Certificate serial number.
  string serial = 2;

  // Subject of the certificate.
  string subject = 3;

  // Issuer of the certificate.
  string issuer = 4;

  // The MD5 hash of the certificate, as a hex-encoded string.
  string md5 = 5;

  // The SHA1 hash of the certificate, as a hex-encoded string.
  string sha1 = 6;

  // The SHA256 hash of the certificate, as a hex-encoded string.
  string sha256 = 7;

  // Indicates when the certificate is first valid.
  google.protobuf.Timestamp not_before = 8;

  // Indicates when the certificate is no longer valid.
  google.protobuf.Timestamp not_after = 9;
}

// Transport Layer Security (TLS) information.
message Tls {
  // Transport Layer Security (TLS) information associated with the client
  // (for example, Certificate or JA3 hash).
  message Client {
    // Client certificate.
    Certificate certificate = 1;

    // JA3 hash from the TLS ClientHello, as a hex-encoded string.
    string ja3 = 2;

    // Host name of the server, that the client is connecting to.
    string server_name = 3;

    // Ciphers supported by the client during client hello.
    repeated string supported_ciphers = 4;
  }

  // Transport Layer Security (TLS) information associated with the server
  // (for example, Certificate or JA3 hash).
  message Server {
    // Server certificate.
    Certificate certificate = 1;

    // JA3 hash from the TLS ServerHello, as a hex-encoded string.
    string ja3s = 2;
  }

  // Certificate information for the client certificate.
  Client client = 1;

  // Certificate information for the server certificate.
  Server server = 2;

  // Cipher used during the connection.
  string cipher = 3;

  // Elliptical curve used for a given cipher.
  string curve = 4;

  // TLS version.
  string version = 5;

  // Protocol.
  string version_protocol = 6;

  // Indicates whether the TLS negotiation was successful.
  bool established = 7;

  // Protocol to be used for tunnel.
  string next_protocol = 8;

  // Indicates whether the TLS connection was resumed from a previous
  // TLS negotiation.
  bool resumed = 9;
}

// Specify the full URL of the HTTP request within "target".
// Also specify any uploaded or downloaded file information within "source"
// or "target".
message Http {
  // The HTTP request method
  // (e.g. "GET", "POST", "PATCH", "DELETE").
  string method = 1;

  // The URL for the HTTP referer.
  string referral_url = 2;

  // The User-Agent request header which includes the application type,
  // operating system, software vendor or software version of the requesting
  // software user agent.
  string user_agent = 3;

  // The response status code, for example
  // 200, 302, 404, or 500.
  int32 response_code = 4;
}

// Information about an entry in the web browser's local history database.
message Browser {
  // The name of the browser.
  enum BrowserType {
    // Default value.
    BROWSER_TYPE_UNSPECIFIED = 0;

    // Chrome.
    CHROME = 1;

    // Firefox.
    FIREFOX = 2;

    // Safari.
    SAFARI = 3;

    // Internet Explorer.
    INTERNET_EXPLORER = 4;

    // Edge.
    EDGE = 5;

    // Opera.
    OPERA = 6;
  }

  // The type of visit to a URL.
  enum UrlVisitType {
    // Default value.
    URL_VISIT_TYPE_UNSPECIFIED = 0;

    // The user clicked a link.
    LINK = 1;

    // The user typed a URL.
    TYPED = 2;

    // The user bookmarked the URL.
    AUTO_BOOKMARK = 3;

    // Loaded in a nested subframe by the parent frame.
    AUTO_SUBFRAME = 4;

    // Loaded in a nested subframe by the user.
    MANUAL_SUBFRAME = 5;

    // The user clicked on auto generated link in browser address bar.
    GENERATED = 6;

    // The page was loaded through command line or is the starting page.
    AUTO_TOPLEVEL = 7;

    // The user submitted a form.
    FORM_SUBMIT = 8;

    // The user reloaded the page.
    RELOAD = 9;

    // The Url was generated by a keyword search configured by user.
    KEYWORD = 10;

    // Corresponds to a visit generated by a keyword search.
    KEYWORD_GENERATED = 11;

    // The user was redirected to the URL.
    REDIRECT = 12;
  }

  // Browser cookie.
  message Cookie {
    // The SameSite attribute of a cookie.
    enum CookieSameSite {
      // Default value.
      COOKIE_SAME_SITE_UNSPECIFIED = 0;

      // Corresponds to SameSite=Strict.
      STRICT = 1;

      // Corresponds to SameSite=Lax.
      LAX = 2;

      // Corresponds to SameSite=None.
      NONE = 3;
    }

    // The unique name identifying the cookie.
    string name = 1;

    // The data stored within the cookie.
    string value = 2;

    // The domain for which the cookie is valid.
    string domain = 3;

    // The URL path for which the cookie is valid.
    string path = 4;

    // The date and time when the cookie will expire.
    google.protobuf.Timestamp expiration_time = 5;

    // Indicates if the cookie is inaccessible via client-side scripts (e.g.,
    // JavaScript).
    bool http_only = 6;

    // Indicates if the cookie should only be sent over secure HTTPS
    // connections.
    bool secure = 7;

    // The maximum age of the cookie in seconds.
    int64 max_age = 8;

    // Affects cross-site request behavior.
    CookieSameSite same_site = 9;

    // Indicates if the cookie is persistent.
    bool session = 10;

    // Shows if the cookies is stored using partitioned storage.
    bool partitioned = 11;
  }

  // The source of the visit.
  enum VisitSource {
    // Default value.
    VISIT_SOURCE_UNSPECIFIED = 0;

    // The visit was synced from another device.
    SYNCED = 1;

    // The visit was from a browser.
    BROWSER = 2;

    // The visit was from an extension.
    EXTENSION = 3;

    // The visit was imported from another browser application.
    IMPORTED = 4;
  }

  // The browser that recorded the history entry (e.g. "Chrome", "Firefox",
  // "Safari", etc.).
  BrowserType browser_type = 1;

  // The browser version.
  string browser_version = 2;

  // The timestamp indicating the initial visit to the URL.
  google.protobuf.Timestamp first_visit_time = 3;

  // The timestamp indicating the most recent visit to the URL.
  google.protobuf.Timestamp last_visit_time = 4;

  // The browser profile associated with the history entry.
  string profile = 5;

  // A boolean value indicating if the URL was typed by the user.
  bool typed = 6;

  // Describes the type of navigation or visit (e.g., direct, redirect, etc.).
  UrlVisitType visit_type = 7;

  // A boolean value indicating if the history entry is hidden.
  bool hidden = 8;

  // Indicates the URI from which the current visit originated.
  string request_origin_uri = 9;

  // The total number of times the Url has been visited.
  int64 visit_count = 10;

  // Describes the criteria used to calculate the visit_count.
  string visit_count_criteria = 11;

  // Represents the textual content of a web page. This field should be kept
  // short. Large strings may affect latency and payload sizes.
  string indexed_content = 12;

  // The timestamp indicating the first time the URL was bookmarked.
  google.protobuf.Timestamp first_bookmarked_time = 13;

  // Information about the cookies.
  repeated Cookie cookies = 14;

  // The number of times the URL was visited with this specific visit type and
  // visit source.
  int64 typed_count = 15;

  // The source of the visit.
  VisitSource visit_source = 16;
}

// Hardware specification details for a resource, including both physical and
// virtual hardware.
message Hardware {
  // Hardware serial number.
  string serial_number = 1;

  // Hardware manufacturer.
  string manufacturer = 2;

  // Hardware model.
  string model = 3;

  // Platform of the hardware CPU (e.g. "Intel Broadwell").
  string cpu_platform = 4;

  // Model description of the hardware CPU
  // (e.g. "2.8 GHz Quad-Core Intel Core i5").
  string cpu_model = 5;

  // Clock speed of the hardware CPU in MHz.
  uint64 cpu_clock_speed = 6;

  // Maximum possible clock speed of the hardware CPU in MHz.
  uint64 cpu_max_clock_speed = 7;

  // Number of CPU cores.
  uint64 cpu_number_cores = 8;

  // Amount of the hardware ramdom access memory (RAM) in Mb.
  uint64 ram = 9;
}

// Platform software information about an operating system.
message PlatformSoftware {
  // The platform operating system.
  Noun.Platform platform = 1;

  // The platform software version (
  // e.g. "Microsoft Windows 1803").
  string platform_version = 2;

  // The platform software patch level (
  // e.g. "Build 17134.48", "SP1").
  string platform_patch_level = 3;
}

// Information about a software package or application.
message Software {
  // The name of the software.
  string name = 1;

  // The version of the software.
  string version = 2;

  // System permissions granted to the software.
  // For example, "android.permission.WRITE_EXTERNAL_STORAGE"
  repeated Permission permissions = 3;

  // The description of the software.
  string description = 4;

  // The name of the software vendor.
  string vendor_name = 5;
}

// Information about a compute asset such as a workstation, laptop, phone,
// virtual desktop, or VM.
message Asset {
  // The role type of the asset.
  enum AssetType {
    // Unspecified asset role.
    ROLE_UNSPECIFIED = 0;

    // A workstation or desktop.
    WORKSTATION = 1;

    // A laptop computer.
    LAPTOP = 2;

    // An IOT asset.
    IOT = 3;

    // A network attached storage device.
    NETWORK_ATTACHED_STORAGE = 4;

    // A printer.
    PRINTER = 5;

    // A scanner.
    SCANNER = 6;

    // A server.
    SERVER = 7;

    // A tape library device.
    TAPE_LIBRARY = 8;

    // A mobile device such as a mobile phone or PDA.
    MOBILE = 9;
  }

  // Deployment status states.
  enum DeploymentStatus {
    // Unspecified deployment status.
    DEPLOYMENT_STATUS_UNSPECIFIED = 0;

    // Asset is active, functional and deployed.
    ACTIVE = 1;

    // Asset is pending decommission and no longer deployed.
    PENDING_DECOMISSION = 2;

    // Asset is decommissioned.
    DECOMISSIONED = 3;
  }

  // A vendor-specific identifier to uniquely identify the entity (a GUID  or
  // similar).
  // This field can be used as an entity indicator for asset entities.
  string product_object_id = 1;

  // Asset hostname or domain name field.
  // This field can be used as an entity indicator for asset entities.
  string hostname = 2;

  // The asset ID. Value must contain the ':' character. For example,
  // cs:abcdd23434.
  // This field can be used as an entity indicator for asset entities.
  string asset_id = 3;

  // A list of IP addresses associated with an asset.
  // This field can be used as an entity indicator for asset entities.
  repeated string ip = 4;

  // List of MAC addresses associated with an asset.
  // This field can be used as an entity indicator for asset entities.
  repeated string mac = 5;

  // List of NAT IP addresses associated with an asset.
  repeated string nat_ip = 22;

  // The first observed time for an asset.
  // The value is calculated on the basis of the
  // first time the identifier was observed.
  google.protobuf.Timestamp first_seen_time = 23;

  // The asset hardware specifications.
  repeated Hardware hardware = 6;

  // The asset operating system platform software.
  PlatformSoftware platform_software = 7;

  // The asset software details.
  repeated Software software = 17;

  // Location of the asset.
  Location location = 8;

  // The category of the asset (e.g. "End User Asset", "Workstation", "Server").
  string category = 9;

  // The type of the asset (e.g. workstation or laptop or server).
  AssetType type = 18;

  // The network domain of the asset (e.g. "corp.acme.com")
  string network_domain = 10;

  // Time the asset was created or provisioned.
  // Deprecate: creation_time should be populated in Attribute as generic
  // metadata.
  google.protobuf.Timestamp creation_time = 11 [deprecated = true];

  // Time the asset was first discovered (by asset management/discoverability
  // software).
  google.protobuf.Timestamp first_discover_time = 12;

  // Time the asset was last discovered (by asset management/discoverability
  // software).
  google.protobuf.Timestamp last_discover_time = 13;

  // Time the asset system or OS was last updated.
  // For all other operations that are not system updates (such as resizing a
  // VM), use Attribute.last_update_time.
  google.protobuf.Timestamp system_last_update_time = 14;

  // Time the asset was last boot started.
  google.protobuf.Timestamp last_boot_time = 15;

  // Metadata labels for the asset.
  // Deprecated: labels should be populated in Attribute as generic metadata.
  repeated Label labels = 16 [deprecated = true];

  // The deployment status of the asset for device lifecycle purposes.
  DeploymentStatus deployment_status = 19;

  // Vulnerabilities discovered on asset.
  repeated Vulnerability vulnerabilities = 21;

  // Generic entity metadata attributes of the asset.
  Attribute attribute = 20;

  // Information about a WMI persistence item.
  WmiPersistenceItem wmi_persistence_item = 24;
}

// Information about a user.
message User {
  // User Account Type.
  enum AccountType {
    // Default user account type.
    ACCOUNT_TYPE_UNSPECIFIED = 0;

    // A human account part of some domain in directory services.
    DOMAIN_ACCOUNT_TYPE = 1;

    // A local machine account.
    LOCAL_ACCOUNT_TYPE = 2;

    // A SaaS service account type (such as Slack or GitHub).
    CLOUD_ACCOUNT_TYPE = 3;

    // A non-human account for data access.
    SERVICE_ACCOUNT_TYPE = 4;

    // A system built in default account.
    DEFAULT_ACCOUNT_TYPE = 5;
  }

  // User system roles.
  enum Role {
    // Default user role.
    UNKNOWN_ROLE = 0;

    // Product administrator with elevated privileges.
    ADMINISTRATOR = 1;

    // System service account for automated privilege access.
    // Deprecated: not a role, instead set User.account_type.
    SERVICE_ACCOUNT = 2 [deprecated = true];
  }

  // A vendor-specific identifier to uniquely identify the entity (e.g. a GUID,
  // LDAP, OID, or similar).
  // This field can be used as an entity indicator for user entities.
  string product_object_id = 7;

  // The ID of the user.
  // This field can be used as an entity indicator for user entities.
  string userid = 1;

  // The display name of the user
  // (e.g. "John Locke").
  string user_display_name = 3;

  // First name of the user (e.g. "John").
  string first_name = 100;

  // Middle name of the user.
  string middle_name = 101;

  // Last name of the user (e.g. "Locke").
  string last_name = 102;

  // Phone numbers for the user.
  repeated string phone_numbers = 103;

  // Personal address of the user.
  Location personal_address = 104;

  // Generic entity metadata attributes of the user.
  Attribute attribute = 8;

  // The first observed time for a user.
  // The value is calculated on the basis of the
  // first time the identifier was observed.
  google.protobuf.Timestamp first_seen_time = 10;

  // Type of user account (for example, service, domain, or cloud). This is
  // somewhat aligned to: <a
  // href="https://attack.mitre.org/techniques/T1078/">https://attack.mitre.org/techniques/T1078/</a>
  AccountType account_type = 9;

  // The ID of the group that the user belongs to.
  // Deprecated in favor of the repeated group_identifiers field.
  string groupid = 2 [deprecated = true];

  // Product object identifiers of the group(s) the user belongs to
  // A vendor-specific identifier to uniquely identify the group(s) the user
  // belongs to (a GUID, LDAP OID, or similar).
  repeated string group_identifiers = 200;

  // The Microsoft Windows SID of the user.
  // This field can be used as an entity indicator for user entities.
  string windows_sid = 4;

  // Email addresses of the user.
  // This field can be used as an entity indicator for user entities.
  repeated string email_addresses = 5;

  // Human capital management identifier.
  // This field can be used as an entity indicator for user entities.
  string employee_id = 6;

  // User job title.
  string title = 601;

  // User job company name.
  string company_name = 602;

  // User job department
  repeated string department = 603;

  // User job office location.
  Location office_address = 604;

  // User job manager(s).
  repeated User managers = 605;

  // User job employment hire date.
  google.protobuf.Timestamp hire_date = 606;

  // User job employment termination date.
  google.protobuf.Timestamp termination_date = 607;

  // User time off leaves from active work.
  repeated TimeOff time_off = 608;

  // User last login timestamp.
  google.protobuf.Timestamp last_login_time = 609;

  // User last password change timestamp.
  google.protobuf.Timestamp last_password_change_time = 610;

  // User password expiration timestamp.
  google.protobuf.Timestamp password_expiration_time = 611;

  // User account expiration timestamp.
  google.protobuf.Timestamp account_expiration_time = 612;

  // User account lockout timestamp.
  google.protobuf.Timestamp account_lockout_time = 613;

  // User last bad password attempt timestamp.
  google.protobuf.Timestamp last_bad_password_attempt_time = 614;

  // System authentication status for user.
  Authentication.AuthenticationStatus user_authentication_status = 701;

  // System role name for user.
  // Deprecated: use attribute.roles.
  string role_name = 702 [deprecated = true];

  // System role description for user.
  // Deprecated: use attribute.roles.
  string role_description = 703 [deprecated = true];

  // System role for user.
  // Deprecated: use attribute.roles.
  Role user_role = 704 [deprecated = true];
}

// System record for leave/time-off from a Human Capital Management (HCM)
// system.
message TimeOff {
  // Interval duration of the leave.
  google.type.Interval interval = 1;

  // Description of the leave if available (e.g. 'Vacation').
  string description = 2;
}

// System permission for resource access and modification.
message Permission {
  // High level categorizations of permission type.
  enum PermissionType {
    // Default permission type.
    UNKNOWN_PERMISSION_TYPE = 0;

    // Administrator write permission.
    ADMIN_WRITE = 1;

    // Administrator read permission.
    ADMIN_READ = 2;

    // Data resource access write permission.
    DATA_WRITE = 3;

    // Data resource access read permission.
    DATA_READ = 4;
  }

  // Name of the permission (e.g. chronicle.analyst.updateRule).
  string name = 1;

  // Description of the permission (e.g. 'Ability to update detect rules').
  string description = 2;

  // Type of the permission.
  PermissionType type = 3;
}

// System role for resource access and modification.
message Role {
  // Well-known system roles.
  enum Type {
    // Default user role.
    TYPE_UNSPECIFIED = 0;

    // Product administrator with elevated privileges.
    ADMINISTRATOR = 1;

    // System service account for automated privilege access.
    SERVICE_ACCOUNT = 2;
  }

  // System role name for user.
  string name = 1;

  // System role description for user.
  string description = 2;

  // System role type for well known roles.
  Type type = 3;
}

// Information about an organizational group.
message Group {
  // Product globally unique user object identifier, such as an LDAP Object
  // Identifier.
  string product_object_id = 1;

  // Group creation time.
  // Deprecated: creation_time should be populated in Attribute as generic
  // metadata.
  google.protobuf.Timestamp creation_time = 100 [deprecated = true];

  // Group display name. e.g. "Finance".
  string group_display_name = 101;

  // Generic entity metadata attributes of the group.
  Attribute attribute = 4;

  // Email addresses of the group.
  repeated string email_addresses = 2;

  // Microsoft Windows SID of the group.
  string windows_sid = 3;
}

// Information about a registry key or value.
message Registry {
  // Type of the registry value. These values are based on the Windows Registry
  // value types:
  // https://learn.microsoft.com/en-us/windows/win32/sysinfo/registry-value-types
  enum Type {
    // Default registry value type used when the type is unknown.
    TYPE_UNSPECIFIED = 0;

    // The registry value is not set and only the key exists.
    NONE = 1;

    // A null-terminated string.
    SZ = 2;

    // A null-terminated string that contains unexpanded references to
    // environment variables
    EXPAND_SZ = 3;

    // Binary data in any form.
    BINARY = 4;

    // A 32-bit number.
    DWORD = 5;

    // A 32-bit number in little-endian format.
    DWORD_LITTLE_ENDIAN = 6;

    // A 32-bit number in big-endian format.
    DWORD_BIG_ENDIAN = 7;

    // A null-terminated Unicode string that contains the target path of a
    // symbolic link.
    LINK = 8;

    // A sequence of null-terminated strings, terminated by an empty string
    MULTI_SZ = 9;

    // A device driver resource list.
    RESOURCE_LIST = 10;

    // A 64-bit number.
    QWORD = 11;

    // A 64-bit number in little-endian format.
    QWORD_LITTLE_ENDIAN = 12;
  }

  // Registry key associated with an application or system component
  // (e.g., HKEY_, HKCU\Environment...).
  string registry_key = 1;

  // Name of the registry value associated with an application or system
  // component (e.g. TEMP).
  string registry_value_name = 2;

  // Data associated with a registry value
  // (e.g. %USERPROFILE%\Local Settings\Temp).
  string registry_value_data = 3;

  // Type of the registry value.
  Type registry_value_type = 4;

  // Binary data associated with a registry value. This field is only populated
  // if the registry value type is BINARY. This field is not populated for
  // other registry value types.
  bytes registry_value_binary_data = 5;
}

// Information about a WMI persistence item.
message WmiPersistenceItem {
  // A brief title or caption for the WMI object.
  string caption = 1;

  // The name of the WMI object.
  string name = 2;

  // The identifier for the setting.
  string setting_id = 3;

  // The base class from which the WMI class is derived (e.g., CIM_Setting).
  string derivation = 4;

  // The number of properties in the WMI object.
  int64 property_count = 5;

  // The relative path to the WMI object (e.g.,
  // Win32_StartupCommand.Command=''').
  string rel_path = 6;

  // The top-level class in the WMI inheritance hierarchy (e.g., CMI_Setting).
  string dynasty = 7;

  // The immediate parent class in the WMI inheritance hierarchy.
  string wmi_super_class = 8;

  // The name of the WMI class.
  string wmi_class = 9;

  // An integer representing the type or version of the WMI object.
  int64 genus = 10;
}

// Information about a location.
message Location {
  // The city.
  string city = 1;

  // The state.
  string state = 2;

  // The country or region.
  string country_or_region = 3;

  // Custom location name (e.g. building or site name like "London Office").
  // For cloud environments, this is the region (e.g. "us-west2").
  string name = 4;

  // Desk name or individual location, typically for an employee in an
  // office.
  // (e.g. "IN-BLR-BCPC-11-1121D").
  string desk_name = 5;

  // Floor name, number or a combination of the two for a building.
  // (e.g. "1-A").
  string floor_name = 6;

  // Deprecated: use region_coordinates.
  float region_latitude = 7 [deprecated = true];

  // Deprecated: use region_coordinates.
  float region_longitude = 8 [deprecated = true];

  // Coordinates for the associated region.
  // See <a
  // href="https://cloud.google.com/vision/docs/reference/rest/v1/LatLng">https://cloud.google.com/vision/docs/reference/rest/v1/LatLng</a>
  // for a description of the fields.
  google.type.LatLng region_coordinates = 9;
}

// Information about a scheduled task.
message ScheduledTask {
  // The minute of the hour (0-59).
  int32 minute = 1;

  // The hour of the day (0-23).
  int32 hour = 2;

  // The day of the month (1-31).
  int32 month_day = 3;

  // The month of the year (1-12).
  int32 month = 4;

  // The day of the week (0-6, Sunday=0).
  int32 week_day = 5;

  // A comment or description for the task.
  string comment = 6;

  // The author or creator of the task.
  string author = 7;
}

// Information about a storage volume.
message Volume {
  // The name of the file system on the volume (e.g., "NTFS", "FAT32").
  string file_system = 1;

  // The path where the volume is mounted (e.g., "C:", "/mnt/data").
  string mount_point = 2;

  // The system path to the device (e.g., "\\.\HarddiskVolume1", "/dev/sda1").
  string device_path = 3;

  // Indicates whether the volume is currently mounted.
  bool is_mounted = 4;

  // Indicates whether the volume is mounted as read-only.
  bool is_read_only = 5;

  // The user-assigned label or name for the volume.
  string name = 6;
}

// Information about a Windows service.
message Service {
  // The type of service.
  enum ServiceType {
    // Default service type.
    SERVICE_TYPE_UNSPECIFIED = 0;

    // A kernel driver.
    KERNEL_DRIVER = 1;

    // A file system driver.
    FILE_SYSTEM_DRIVER = 2;

    // A process that is owned by the service. This is a Windows-specific
    // service type.
    WIN32_OWN_PROCESS = 3;

    // A process that is shared by the service. This is a Windows-specific
    // service type.
    WIN32_SHARE_PROCESS = 4;
  }

  // How the service is started.
  enum StartupType {
    // Default startup type.
    STARTUP_TYPE_UNSPECIFIED = 0;

    // The service is started automatically.
    AUTOMATIC = 1;

    // The service is started manually by a user.
    MANUAL = 2;

    // The service is disabled and will not start automatically.
    DISABLED = 3;
  }

  // The current status of the service.
  enum State {
    // Default service status.
    STATE_UNSPECIFIED = 0;

    // The service is running.
    RUNNING = 1;

    // The service is stopped. This is a Windows-specific service status.
    STOPPED = 2;

    // The service is paused. This is a Windows-specific service status.
    PAUSED = 3;

    // The service is completed.
    COMPLETED = 4;

    // The service is starting.
    START_PENDING = 5;

    // The service is stopping.
    STOP_PENDING = 6;

    // The service is pausing.
    PAUSE_PENDING = 7;

    // The service is continuing.
    CONTINUE_PENDING = 8;
  }

  // The user-friendly display name of the service.
  string display_name = 1;

  // The type of service.
  ServiceType service_type = 3;

  // The startup type of the service.
  StartupType startup_type = 4;

  // Output only. The status of the service.
  State state = 5 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// Information about a resource such as a task, Cloud Storage
// bucket, database, disk, logical policy, or something similar.
message Resource {
  // The type of resource.
  enum ResourceType {
    // Default type.
    UNSPECIFIED = 0;

    // Mutex.
    MUTEX = 1;

    // Task.
    TASK = 2;

    // Named pipe.
    PIPE = 3;

    // Device.
    DEVICE = 4;

    // Firewall rule.
    FIREWALL_RULE = 5;

    // Mailbox folder.
    MAILBOX_FOLDER = 6;

    // VPC Network.
    VPC_NETWORK = 7;

    // Virtual machine.
    VIRTUAL_MACHINE = 8;

    // Storage bucket.
    STORAGE_BUCKET = 9;

    // Storage object.
    STORAGE_OBJECT = 10;

    // Database.
    DATABASE = 11;

    // Data table.
    TABLE = 12;

    // Cloud project.
    CLOUD_PROJECT = 13;

    // Cloud organization.
    CLOUD_ORGANIZATION = 14;

    // Service account.
    SERVICE_ACCOUNT = 15;

    // Access policy.
    ACCESS_POLICY = 16;

    // Cluster.
    CLUSTER = 17;

    // Settings.
    SETTING = 18;

    // Dataset.
    DATASET = 19;

    // Endpoint that receive traffic from a load balancer or proxy.
    BACKEND_SERVICE = 20;

    // Pod, which is a collection of containers. Often used in Kubernetes.
    POD = 21;

    // Container.
    CONTAINER = 22;

    // Cloud function.
    FUNCTION = 23;

    // Runtime.
    RUNTIME = 24;

    // IP address.
    IP_ADDRESS = 25;

    // Disk.
    DISK = 26;

    // Volume.
    VOLUME = 27;

    // Machine image.
    IMAGE = 28;

    // Snapshot.
    SNAPSHOT = 29;

    // Repository.
    REPOSITORY = 30;

    // Credential, e.g. access keys, ssh keys, tokens, certificates.
    CREDENTIAL = 31;

    // Load balancer.
    LOAD_BALANCER = 32;

    // Gateway.
    GATEWAY = 33;

    // Subnet.
    SUBNET = 34;

    // User.
    USER = 35;

    // Service.
    SERVICE = 36;
  }

  // Deprecated: use resource_type instead.
  string type = 1 [deprecated = true];

  // Resource type.
  ResourceType resource_type = 5;

  // Resource sub-type (e.g. "BigQuery", "Bigtable").
  string resource_subtype = 6;

  // Deprecated: Use resource.name or resource.product_object_id.
  string id = 2 [deprecated = true];

  // The full name of the resource. For example,
  // Google Cloud: //cloudresourcemanager.googleapis.com/projects/wombat-123,
  // and AWS: arn:aws:iam::123456789012:user/johndoe.
  string name = 3;

  // The parent of the resource.
  // For a database table, the parent is the database. For a storage object,
  // the bucket name.  Deprecated: use resource_ancestors.name.
  string parent = 4 [deprecated = true];

  // A vendor-specific identifier to uniquely identify the entity (a GUID,
  // OID, or similar)
  // This field can be used as an entity indicator for a Resource entity.
  string product_object_id = 8;

  // Generic entity metadata attributes of the resource.
  Attribute attribute = 7;

  // Information about a scheduled task associated with the resource.
  ScheduledTask scheduled_task = 9;

  // Information about a storage volume associated with the resource.
  Volume volume = 10;

  // Information about a Windows service associated with the resource.
  Service service = 11;
}

// Key value labels.
message Label {
  // The key.
  string key = 1;

  // The value.
  string value = 2;

  // Where the label is derived from.
  string source = 3;

  // Indicates whether this label can be used for Data RBAC
  bool rbac_enabled = 4;
}

// Metadata related to the cloud environment.
message Cloud {
  // The service provider environment.
  enum CloudEnvironment {
    // Default.
    UNSPECIFIED_CLOUD_ENVIRONMENT = 0;

    // Google Cloud Platform.
    GOOGLE_CLOUD_PLATFORM = 1;

    // Amazon Web Services.
    AMAZON_WEB_SERVICES = 2;

    // Microsoft Azure.
    MICROSOFT_AZURE = 3;
  }

  // The Cloud environment.
  CloudEnvironment environment = 1;

  // The cloud environment VPC.
  // Deprecated.
  Resource vpc = 2 [deprecated = true];

  // The cloud environment project information.
  // Deprecated: Use Resource.resource_ancestors
  Resource project = 3 [deprecated = true];

  // The cloud environment availability zone (different from region which is
  // location.name).
  string availability_zone = 4;
}

// Information about an artifact. The artifact can only be an IP.
message Artifact {
  // IP address of the artifact.
  // This field can be used as an entity indicator for an external destination
  // IP entity.
  string ip = 1;

  // The prevalence of the artifact within the customer's environment.
  Prevalence prevalence = 2;

  // First seen timestamp of the IP in the customer's environment.
  google.protobuf.Timestamp first_seen_time = 3;

  // Last seen timestamp of the IP address in the customer's environment.
  google.protobuf.Timestamp last_seen_time = 4;

  // Location of the Artifact's IP address.
  Location location = 5;

  // Network information related to the Artifact's IP address.
  Network network = 6;

  // Owner of the Autonomous System to which the IP address belongs.
  string as_owner = 7;

  // Autonomous System Number to which the IP address belongs.
  int64 asn = 8;

  // The JARM hash for the IP address.
  // (https://engineering.salesforce.com/easily-identify-malicious-servers-on-the-internet-with-jarm-e095edac525a).
  string jarm = 9;

  // SSL certificate information about the IP address.
  SSLCertificate last_https_certificate = 10;

  // Most recent date for the certificate in VirusTotal.
  google.protobuf.Timestamp last_https_certificate_date = 11;

  // RIR (one of the current RIRs: AFRINIC, ARIN, APNIC, LACNIC or RIPE NCC).
  string regional_internet_registry = 12;

  // Identification attributes
  repeated string tags = 13;

  // WHOIS information as returned from the pertinent WHOIS server.
  string whois = 14;

  // Date of the last update of the WHOIS record in VirusTotal.
  google.protobuf.Timestamp whois_date = 15;

  // VPN tunnels.
  repeated Tunnels tunnels = 16;

  // Whether the VPN tunnels are configured for anonymous browsing or not.
  bool anonymous = 17;

  // Entity or software accessing or utilizing network resources.
  ArtifactClient artifact_client = 18;

  // This field lists potential risks associated with the network activity.
  repeated string risks = 19;
}

// VPN tunnels.
message Tunnels {
  // The provider of the VPN tunnels being used.
  string provider = 1;

  // The type of the VPN tunnels.
  string type = 2;
}

// Entity or software accessing or utilizing network resources.
message ArtifactClient {
  // The behaviors of the client accessing the network.
  repeated string behaviors = 1;

  // The type of proxies used by the client.
  repeated string proxies = 2;
}

// Difference hash and MD5 hash of the domain's favicon.
message Favicon {
  // Favicon's MD5 hash.
  string raw_md5 = 1;

  // Difference hash.
  string dhash = 2;
}

// DNS record.
message DNSRecord {
  // Type.
  string type = 1;

  // Value.
  string value = 2;

  // Time to live.
  google.protobuf.Duration ttl = 3;

  // Priority.
  int64 priority = 4;

  // Retry.
  int64 retry = 5;

  // Refresh.
  google.protobuf.Duration refresh = 6;

  // Minimum.
  google.protobuf.Duration minimum = 7;

  // Expire.
  google.protobuf.Duration expire = 8;

  // Serial.
  int64 serial = 9;

  // Rname.
  string rname = 10;
}

// SSL certificate.
message SSLCertificate {
  // Certificate's signature and algorithm.
  message CertSignature {
    // Signature.
    string signature = 1;

    // Algorithm.
    string signature_algorithm = 2;
  }

  // Identifies the public key to be used to verify the signature on this
  // certificate or CRL.
  message AuthorityKeyId {
    // Key hexdump.
    string keyid = 1;

    // Serial number hexdump.
    string serial_number = 2;
  }

  // Certificate's extensions.
  message Extension {
    // Whether the subject acts as a certificate authority (CA) or not.
    bool ca = 1;

    // Identifies the public key being certified.
    string subject_key_id = 2;

    // Identifies the public key to be used to verify the signature on this
    // certificate or CRL.
    AuthorityKeyId authority_key_id = 3;

    // The purpose for which the certified public key is used.
    string key_usage = 6;

    // Authority information access locations are URLs that are added to a
    // certificate in its authority information access extension.
    string ca_info_access = 7;

    // CRL distribution points to which a certificate user should refer to
    // ascertain if the certificate has been revoked.
    string crl_distribution_points = 8;

    // One or more purposes for which the certified public key may be used, in
    // addition to or in place of the basic purposes indicated in the key usage
    // extension field.
    string extended_key_usage = 9;

    // Contains one or more alternative names, using any of a variety of name
    // forms, for the entity that is bound by the CA to the certified public
    // key.
    string subject_alternative_name = 10;

    // Different certificate policies will relate to different applications
    // which may use the certified key.
    string certificate_policies = 11;

    // Used to include free-form text comments inside certificates.
    string netscape_cert_comment = 12;

    // BMP data value "DomainController". See MS Q291010.
    string cert_template_name_dc = 13;

    // Identify whether the certificate subject is an SSL client, an SSL server,
    // or a CA.
    bool netscape_certificate = 14;

    // Whether the certificate includes a logotype.
    bool pe_logotype = 15;

    // Whether the certificate has an old authority key identifier extension.
    bool old_authority_key_id = 16;
  }

  // Subject data.
  message Subject {
    // C: Country name.
    string country_name = 1;

    // CN: CommonName.
    string common_name = 2;

    // L: Locality.
    string locality = 3;

    // O: Organization.
    string organization = 4;

    // OU: OrganizationalUnit.
    string organizational_unit = 5;

    // ST: StateOrProvinceName.
    string state_or_province_name = 6;
  }

  // RSA public key information.
  message RSA {
    // Key size.
    int64 key_size = 1;

    // Key modulus hexdump.
    string modulus = 2;

    // Key exponent hexdump.
    string exponent = 3;
  }

  // EC public key information.
  message EC {
    // Curve name.
    string oid = 1;

    // Public key hexdump.
    string pub = 2;
  }

  // Subject public key info.
  message PublicKey {
    // Any of "RSA", "DSA" or "EC". Indicates the algorithm used to generate the
    // certificate.
    string algorithm = 1;

    // RSA public key information.
    RSA rsa = 2;
  }

  // Defines certificate's validity period.
  message Validity {
    // Expiry date.
    google.protobuf.Timestamp expiry_time = 1;

    // Issue date.
    google.protobuf.Timestamp issue_time = 2;
  }

  // Certificate's signature and algorithm.
  CertSignature cert_signature = 1;

  // (DEPRECATED) certificate's extension.
  Extension extension = 2 [deprecated = true];

  // Certificate's extensions.
  google.protobuf.Struct cert_extensions = 14;

  // Date the certificate was first retrieved by VirusTotal.
  google.protobuf.Timestamp first_seen_time = 3;

  // Certificate's issuer data.
  Subject issuer = 4;

  // EC public key information.
  EC ec = 5;

  // Certificate's serial number hexdump.
  string serial_number = 6;

  // Algorithm used for the signature (for example, "sha1RSA").
  string signature_algorithm = 7;

  // Certificate content length.
  int64 size = 8;

  // Certificate's subject data.
  Subject subject = 9;

  // Certificate's content SHA1 hash.
  string thumbprint = 10;

  // Certificate's content SHA256 hash.
  string thumbprint_sha256 = 11;

  // Certificate's validity period.
  Validity validity = 12;

  // Certificate version (typically "V1", "V2" or "V3").
  string version = 13;

  // Public key information.
  PublicKey public_key = 15;
}

// Domain's position in popularity ranks for sources such as Alexa, Quantcast,
// or Statvoo.
message PopularityRank {
  // Name of the rank serial number hexdump.
  string giver = 1;

  // Rank position.
  int64 rank = 2;

  // Timestamp when the rank was ingested.
  google.protobuf.Timestamp ingestion_time = 3;
}

// URL Tracker.
message Tracker {
  // Tracker name.
  string tracker = 1;

  // Tracker ID, if available.
  string id = 2;

  // Tracker ingestion date.
  google.protobuf.Timestamp timestamp = 3;

  // Tracker script URL.
  string url = 4;
}

// Url.
message Url {
  // URL.
  string url = 1;

  // Categorisation done by VirusTotal partners.
  repeated string categories = 2;

  // Difference hash and MD5 hash of the URL's.
  Favicon favicon = 3;

  // Meta tags (only for URLs downloading HTML).
  google.protobuf.Struct html_meta = 4;

  // If the original URL redirects, where does it end.
  string last_final_url = 5;

  // HTTP response code of the last response.
  int32 last_http_response_code = 6;

  // Length in bytes of the content received.
  int64 last_http_response_content_length = 7;

  // URL response body's SHA256 hash.
  string last_http_response_content_sha256 = 8;

  // Website's cookies.
  google.protobuf.Struct last_http_response_cookies = 9;

  // Headers and values of the last HTTP response.
  google.protobuf.Struct last_http_response_headers = 10;

  // Tags.
  repeated string tags = 11;

  // Webpage title.
  string title = 12;

  // Trackers found in the URL in a historical manner.
  repeated Tracker trackers = 13;
}

// Information about a domain.
message Domain {
  // The domain name.
  // This field can be used as an entity indicator for Domain entities.
  string name = 1;

  // The prevalence of the domain within the customer's environment.
  Prevalence prevalence = 2;

  // First seen timestamp of the domain in the customer's environment.
  google.protobuf.Timestamp first_seen_time = 3;

  // Last seen timestamp of the domain in the customer's environment.
  google.protobuf.Timestamp last_seen_time = 4;

  // Registrar name . FOr example, "Wild West Domains, Inc. (R120-LROR)",
  // "GoDaddy.com, LLC", or "PDR LTD. D/B/A PUBLICDOMAINREGISTRY.COM".
  string registrar = 5;

  // Contact email address.
  string contact_email = 6;

  // Whois server name.
  string whois_server = 7;

  // Repeated list of name servers.
  repeated string name_server = 8;

  // Domain creation time.
  google.protobuf.Timestamp creation_time = 9;

  // Last updated time.
  google.protobuf.Timestamp update_time = 10;

  // Expiration time.
  google.protobuf.Timestamp expiration_time = 11;

  // Audit updated time.
  google.protobuf.Timestamp audit_update_time = 12;

  // Domain status. See
  // <a
  // href="https://www.icann.org/resources/pages/epp-status-codes-2014-06-16-en">https://www.icann.org/resources/pages/epp-status-codes-2014-06-16-en</a>
  // for meanings of possible values
  string status = 13;

  // Parsed contact information for the registrant of the domain.
  User registrant = 14;

  // Parsed contact information for the administrative contact for the domain.
  User admin = 15;

  // Parsed contact information for the technical contact for the domain
  User tech = 16;

  // Parsed contact information for the billing contact of the domain.
  User billing = 17;

  // Parsed contact information for the zone.
  User zone = 18;

  // WHOIS raw text.
  bytes whois_record_raw_text = 19;

  // Registry Data raw text.
  bytes registry_data_raw_text = 20;

  // IANA Registrar ID.  See
  // <a
  // href="https://www.iana.org/assignments/registrar-ids/registrar-ids.xhtml">https://www.iana.org/assignments/registrar-ids/registrar-ids.xhtml</a>
  int32 iana_registrar_id = 21;

  // Indicates whether the domain appears to be using a private registration
  // service to mask the owner's contact information.
  bool private_registration = 22;

  // Categories assign to the domain as retrieved from VirusTotal.
  repeated string categories = 23;

  // Includes difference hash and MD5 hash of the domain's favicon.
  Favicon favicon = 24;

  // Domain's JARM hash.
  string jarm = 25;

  // Domain's DNS records from the last scan.
  repeated DNSRecord last_dns_records = 26;

  // Date when the DNS records list was retrieved by VirusTotal.
  google.protobuf.Timestamp last_dns_records_time = 27;

  // SSL certificate object retrieved last time the domain was analyzed.
  SSLCertificate last_https_certificate = 28;

  // When the certificate was retrieved by VirusTotal.
  google.protobuf.Timestamp last_https_certificate_time = 29;

  // Domain's position in popularity ranks such as Alexa, Quantcast, Statvoo,
  // etc
  repeated PopularityRank popularity_ranks = 30;

  // List of representative attributes.
  repeated string tags = 31;

  // Date of the last update of the WHOIS record.
  google.protobuf.Timestamp whois_time = 32;
}

// The Noun type is used to represent the different entities in an event:
// principal, src, target, observer, intermediary, and about. It stores
// attributes known about the entity. For example, if the entity is a device
// with multiple IP or MAC addresses, it stores the IP and MAC addresses that
// are relevant to the event.
message Noun {
  // Operating system platform.
  enum Platform {
    // Default value.
    UNKNOWN_PLATFORM = 0;

    // Microsoft Windows.
    WINDOWS = 1;

    // macOS.
    MAC = 2;

    // Linux.
    LINUX = 3;

    // Deprecated: see cloud.environment.
    GCP = 4 [deprecated = true];

    // Deprecated: see cloud.environment.
    AWS = 5 [deprecated = true];

    // Deprecated: see cloud.environment.
    AZURE = 6 [deprecated = true];

    // IOS
    IOS = 7;

    // Android
    ANDROID = 8;

    // Chrome OS
    CHROME_OS = 9;
  }

  // Client hostname or domain name field.
  // Hostname also doubles as the domain for remote entities.
  // This field can be used as an entity indicator for asset entities.
  string hostname = 1;

  // Information about the domain.
  Domain domain = 30;

  // Information about an artifact.
  Artifact artifact = 32;

  // Information about the URL.
  Url url_metadata = 37;

  // Information about an entry in the web browser's local history database.
  Browser browser = 38;

  // The asset ID.
  // This field can be used as an entity indicator for asset entities.
  string asset_id = 2;

  // Information about the user.
  User user = 3;

  // Information about the user's management chain (reporting hierarchy).
  // Note: user_management_chain is only populated when data is exported to
  // BigQuery since recursive fields (e.g. user.managers) are not supported by
  // BigQuery.
  repeated User user_management_chain = 29;

  // Information about the group.
  Group group = 20;

  // Information about the process.
  Process process = 4;

  // Information about the process's ancestors ordered from immediate ancestor
  // (parent process) to root.
  // Note: process_ancestors is only populated when data is exported to BigQuery
  // since recursive fields (e.g. process.parent_process) are not supported by
  // BigQuery.
  repeated Process process_ancestors = 28;

  // Information about the asset.
  Asset asset = 27;

  // A list of IP addresses associated with a network connection.
  // This field can be used as an entity indicator for asset entities.
  repeated string ip = 6;

  // A list of NAT translated IP addresses associated with a network connection.
  repeated string nat_ip = 21;

  // Source or destination network port number when a specific network
  // connection is described within an event.
  int32 port = 7;

  // NAT external network port number when a specific network connection is
  // described within an event.
  int32 nat_port = 22;

  // List of MAC addresses associated with a device.
  // This field can be used as an entity indicator for asset entities.
  repeated string mac = 8;

  // Domain which the device belongs to (for example, the Microsoft Windows
  // domain).
  string administrative_domain = 9;

  // Namespace which the device belongs to, such as "AD forest".
  // Uses for this field include Microsoft Windows AD forest, the name of
  // subsidiary, or the name of acquisition.
  // This field can be used along with an asset indicator to identify an asset.
  string namespace = 19;

  // The URL.
  string url = 10;

  // Information about the file.
  File file = 11;

  // Email address.
  // Only filled in for security_result.about
  string email = 12;

  // Registry information.
  Registry registry = 13;

  // The name of an application or service.
  // Some SSO solutions only capture the name of a target application
  // such as "Atlassian" or "Chronicle".
  string application = 14;

  // Platform.
  Platform platform = 5;

  // Platform version. For example,
  // "Microsoft Windows 1803".
  string platform_version = 15;

  // Platform patch level.
  // For example, "Build 17134.48"
  string platform_patch_level = 16;

  // Cloud metadata.
  // Deprecated: cloud should be populated in entity Attribute as generic
  // metadata (e.g. asset.attribute.cloud).
  Cloud cloud = 24 [deprecated = true];

  // Physical location. For cloud environments, set the region in
  // location.name.
  Location location = 17;

  // Deprecated: use ip_geo_artifact.location instead.
  repeated Location ip_location = 34 [deprecated = true];

  // Enriched geographic information corresponding to an IP address.
  // Specifically, location and network data.
  repeated Artifact ip_geo_artifact = 35;

  // Information about the resource (e.g. scheduled task, calendar entry).
  // This field should not be used for files, registry, or processes because
  // these objects are already part of Noun.
  Resource resource = 18;

  // Information about the resource's ancestors ordered from immediate ancestor
  // (starting with parent resource).
  repeated Resource resource_ancestors = 31;

  // Labels are key-value pairs.
  // For example: key = "env", value = "prod".
  // Deprecated: labels should be populated in entity Attribute as generic
  // metadata (e.g. user.attribute.labels).
  repeated Label labels = 23 [deprecated = true];

  // Finding to which the Analyst updated the feedback.
  Id object_reference = 25;

  // Analyst feedback/investigation for alerts.
  Investigation investigation = 26;

  // Network details, including sub-messages with details on each protocol
  // (for example, DHCP, DNS, or HTTP).
  Network network = 33;

  // A list of security results.
  repeated SecurityResult security_result = 36;
}

// Categorization options for the validity of a finding (for example, whether it
// reflects an actual security incident).
enum Verdict {
  // An unspecified verdict.
  VERDICT_UNSPECIFIED = 0;

  // A categorization of the finding as a "true positive".
  TRUE_POSITIVE = 1;

  // A categorization of the finding as a "false positive".
  FALSE_POSITIVE = 2;
}

// Categorization options for the usefulness of a finding.
enum Reputation {
  // An unspecified reputation.
  REPUTATION_UNSPECIFIED = 0;

  // A categorization of the finding as useful.
  USEFUL = 1;

  // A categorization of the finding as not useful.
  NOT_USEFUL = 2;
}

// Describes status of a finding.
enum Status {
  // Unspecified finding status.
  STATUS_UNSPECIFIED = 0;

  // New finding.
  NEW = 1;

  // When a finding has feedback.
  REVIEWED = 2;

  // When an analyst closes an finding.
  CLOSED = 3;

  // Open. Used to indicate that a Case / Alert is open.
  OPEN = 4;
}

// Represents the aggregated state of an investigation such as categorization,
// severity, and status. Can be expanded to include analyst assignment details
// and more.
message Investigation {
  // Describes reason a finding investigation was resolved.
  optional Verdict verdict = 2;

  // Describes whether a finding was useful or not-useful.
  optional Reputation reputation = 3;

  // Severity score for a finding set by an analyst.
  optional uint32 severity_score = 4;

  // Describes the workflow status of a finding.
  optional Status status = 5;

  // Comment added by the Analyst.
  repeated string comments = 6;

  // Priority of the Alert or Finding set by analyst.
  optional Priority priority = 7;

  // Root cause of the Alert or Finding set by analyst.
  optional string root_cause = 8;

  // Reason for closing the Case or Alert.
  optional Reason reason = 9;

  // Risk score for a finding set by an analyst.
  optional uint32 risk_score = 10;

  // Identifier for the investigation
  optional string id = 11;
}

// Tags are event metadata which is set by examining event contents
// post-parsing. For example, a UDM event may be assigned a tenant_id based on
// certain customer-defined parameters.
message Tags {
  // A list of subtenant ids that this event belongs to.
  repeated bytes tenant_id = 1;

  // A list of sink name values defined in DataTap configurations.
  repeated string data_tap_config_name = 2;
}

// Priority that is assigned to a Case or Alert.
enum Priority {
  // Default priority level.
  PRIORITY_UNSPECIFIED = 0;

  // Informational priority.
  PRIORITY_INFO = 100;

  // Low priority.
  PRIORITY_LOW = 200;

  // Medium priority.
  PRIORITY_MEDIUM = 300;

  // High priority.
  PRIORITY_HIGH = 400;

  // Critical priority.
  PRIORITY_CRITICAL = 500;
}

// Reason for closing an Alert or Case in the SOAR product.
enum Reason {
  // Default reason.
  REASON_UNSPECIFIED = 0;

  // Case or Alert not malicious.
  REASON_NOT_MALICIOUS = 1;

  // Case or Alert is malicious.
  REASON_MALICIOUS = 2;

  // Case or Alert is under maintenance.
  REASON_MAINTENANCE = 3;
}

// MITRE ATT&CK details.
message AttackDetails {
  // Tactic information related to an attack or threat.
  message Tactic {
    // Tactic ID (e.g. "TA0043").
    string id = 1;

    // Tactic Name (e.g. "Reconnaissance")
    string name = 2;
  }

  // Technique information related to an attack or threat.
  message Technique {
    // Technique ID (e.g. "T1595").
    string id = 1;

    // Technique Name (e.g. "Active Scanning").
    string name = 2;

    // Subtechnique ID (e.g. "T1595.001").
    string subtechnique_id = 3;

    // Subtechnique Name (e.g. "Scanning IP Blocks").
    string subtechnique_name = 4;
  }

  // ATT&CK version (e.g. 12.1).
  string version = 1;

  // Tactics employed.
  repeated Tactic tactics = 2;

  // Techniques employed.
  repeated Technique techniques = 3;
}

// GCTI threat verdict levels.
enum ThreatVerdict {
  // Unspecified threat verdict level.
  THREAT_VERDICT_UNSPECIFIED = 0;

  // Undetected threat verdict level.
  UNDETECTED = 1;

  // Suspicious threat verdict level.
  SUSPICIOUS = 2;

  // Malicious threat verdict level.
  MALICIOUS = 3;
}

// BoolSequence represents a sequence of bools.
message BoolSequence {
  // bool sequence.
  repeated bool bool_vals = 1;
}

// BytesSequence represents a sequence of bytes.
message BytesSequence {
  // bytes sequence.
  repeated bytes bytes_vals = 1;
}

// DoubleSequence represents a sequence of doubles.
message DoubleSequence {
  // double sequence.
  repeated double double_vals = 1;
}

// Int64Sequence represents a sequence of int64s.
message Int64Sequence {
  // int64 sequence.
  repeated int64 int64_vals = 1;
}

// Uint64Sequence represents a sequence of uint64s.
message Uint64Sequence {
  // uint64 sequence.
  repeated uint64 uint64_vals = 1;
}

// StringSequence represents a sequence of string.
message StringSequence {
  // string sequence.
  repeated string string_vals = 1;
}
