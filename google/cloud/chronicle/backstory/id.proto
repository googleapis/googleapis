// Copyright 2026 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

package backstory;

option csharp_namespace = "Google.Cloud.Chronicle.Backstory";
option go_package = "google.golang.org/genproto/googleapis/cloud/chronicle/backstory;backstory";
option java_multiple_files = true;
option java_package = "com.google.cloud.chronicle.backstory";
option php_namespace = "Google\\Cloud\\Chronicle\\Backstory";
option ruby_package = "Google::Cloud::Chronicle::Backstory";

// Identifier to identify a UDM object like a UDM event, Entity, Collection.
// The full identifier for persistence is created by setting the 32 most
// significant bits as the Id.Namespace enum This is a convenience wrapper to
// define the id space enum values and provide an easy interface for RPCs, most
// persistence use cases should use a denormalized form.
message Id {
  // Extracted Namespace Component
  enum Namespace {
    // Ingested and Normalized telemetry events
    NORMALIZED_TELEMETRY = 0;

    // Ingested Raw telemetry
    RAW_TELEMETRY = 1;

    // Chronicle Rules engine
    RULE_DETECTIONS = 2;

    // Uppercase
    UPPERCASE = 3;

    // DSML - Machine Intelligence
    MACHINE_INTELLIGENCE = 4;

    // A normalized telemetry event from Google Security Command Center.
    SECURITY_COMMAND_CENTER = 5;

    // Unspecified Namespace
    UNSPECIFIED = 6;

    // An alert coming from other SIEMs via Chronicle SOAR.
    SOAR_ALERT = 7;

    // VirusTotal.
    VIRUS_TOTAL = 8;
  }

  // Namespace the id belongs to.
  Namespace namespace = 1;

  // Full raw ID.
  bytes id = 2;

  // Some ids are stored as strings that are not able to be translated to bytes,
  // so store these separately.
  // Ex. detection id of the form de_aaaaaaaa-aaaa...
  string string_id = 3;
}
